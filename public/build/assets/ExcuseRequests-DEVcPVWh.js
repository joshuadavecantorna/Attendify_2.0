import{d as B,r as $,u as L,a as m,o as u,b as s,e,h as P,w as a,f as l,i as r,p as T,k as f,F as b,g as S,j as k,t as n,l as A,m as U}from"./app-C48M2Hbf.js";import{_ as y}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DLf32hWL.js";import{_ as c,b as p,c as x,a as g,d as O}from"./CardTitle.vue_vue_type_script_setup_true_lang-C_SXf6sx.js";import{_ as M,a as Y,b as G,c as z,d as I}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BZqu6jey.js";import{_ as J}from"./DialogTrigger.vue_vue_type_script_setup_true_lang-D3W8T1Es.js";import{_ as X}from"./Input.vue_vue_type_script_setup_true_lang-LlMu3lUK.js";import{_ as w}from"./Label.vue_vue_type_script_setup_true_lang-Bran7ItV.js";import{_ as H,a as K,b as Q,c as W,d as Z}from"./SelectValue.vue_vue_type_script_setup_true_lang-q1QW1QZo.js";import{_ as ee}from"./Textarea.vue_vue_type_script_setup_true_lang-DmS7qxUR.js";import{_ as te}from"./index-BK1wJ5rr.js";import{F as h,_ as se}from"./AppLayout.vue_vue_type_script_setup_true_lang-CnyaKS-G.js";import{P as C}from"./plus-2b8g_OLT.js";import{C as D}from"./circle-check-big-LxXuhWm2.js";import{C as R}from"./clock-EnjFP69k.js";import{C as j}from"./circle-x-Bbl5gLu8.js";import"./users-B1vNMOg3.js";import"./useForwardExpose-DZx6DsPP.js";import"./check-BuM2rGYF.js";import"./RovingFocusGroup-DTuHG1ky.js";const ae={class:"flex h-full flex-1 flex-col gap-6 p-6"},oe={class:"flex items-center justify-between"},le={class:"space-y-2"},ne={key:0,class:"text-sm text-red-600"},re={class:"space-y-2"},de={key:0,class:"text-sm text-red-600"},ie={class:"space-y-2"},ue={key:0,class:"text-xs text-green-600"},me={key:1,class:"text-sm text-red-600"},fe={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-4"},_e={class:"text-2xl font-bold"},ce={class:"text-2xl font-bold text-green-600"},pe={class:"text-2xl font-bold text-yellow-600"},xe={class:"text-2xl font-bold text-red-600"},ge={class:"space-y-4"},ve={class:"flex items-start justify-between"},be={class:"font-medium"},ye={class:"text-sm text-muted-foreground"},we={class:"flex items-center space-x-2"},he={class:"grid gap-3 md:grid-cols-2"},$e={class:"text-sm"},Se={class:"text-sm"},ke={key:0},Ce=["href"],De={key:0,class:"border-t pt-4 mt-4 grid gap-3 md:grid-cols-2"},Re={class:"text-sm"},je={key:0,class:"mt-3"},Fe={class:"text-sm"},qe={key:0,class:"text-center py-8"},We=B({__name:"ExcuseRequests",props:{requests:{},classes:{}},setup(Ee){const F=[{label:"Dashboard",url:"/dashboard"},{label:"Excuse Requests"}],v=$(!1),d=L({attendance_session_id:"",reason:"",attachment:null}),_=$(null),q=i=>{switch(i){case"approved":return"default";case"pending":return"secondary";case"rejected":return"destructive";default:return"outline"}},E=i=>{switch(i){case"approved":return D;case"pending":return R;case"rejected":return j;default:return h}},V=i=>{const t=i.target;t.files&&t.files[0]&&(_.value=t.files[0],d.attachment=t.files[0])},N=()=>{d.post("/student/excuse-requests",{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{v.value=!1,d.reset(),_.value=null,U.reload({only:["requests"]})},onError:i=>{console.error("Submission errors:",i)}})};return(i,t)=>(u(),m(b,null,[s(e(P),{title:"Excuse Requests"}),s(se,{breadcrumbs:F},{default:a(()=>[l("div",ae,[l("div",oe,[t[11]||(t[11]=l("div",null,[l("h1",{class:"text-3xl font-bold"},"Excuse Requests"),l("p",{class:"text-muted-foreground"},"Submit and track your absence excuse requests")],-1)),s(e(M),{open:v.value,"onUpdate:open":t[2]||(t[2]=o=>v.value=o)},{default:a(()=>[s(e(J),{"as-child":""},{default:a(()=>[s(e(y),null,{default:a(()=>[s(e(C),{class:"mr-2 h-4 w-4"}),t[4]||(t[4]=r(" New Request ",-1))]),_:1,__:[4]})]),_:1}),s(e(Y),{class:"sm:max-w-md"},{default:a(()=>[s(e(G),null,{default:a(()=>[s(e(z),null,{default:a(()=>t[5]||(t[5]=[r("Submit Excuse Request",-1)])),_:1,__:[5]}),s(e(I),null,{default:a(()=>t[6]||(t[6]=[r(" Provide details about your absence and the reason for your excuse request. ",-1)])),_:1,__:[6]})]),_:1}),l("form",{onSubmit:T(N,["prevent"]),class:"space-y-4"},[l("div",le,[s(e(w),{for:"class"},{default:a(()=>t[7]||(t[7]=[r("Class",-1)])),_:1,__:[7]}),s(e(H),{"model-value":e(d).attendance_session_id,"onUpdate:modelValue":t[0]||(t[0]=o=>e(d).attendance_session_id=o)},{default:a(()=>[s(e(K),null,{default:a(()=>[s(e(Q),{placeholder:"Select a class session"})]),_:1}),s(e(W),null,{default:a(()=>[(u(!0),m(b,null,S(i.classes,o=>(u(),k(e(Z),{key:o.id,value:String(o.id)},{default:a(()=>[r(n(o.name)+" - "+n(o.course)+" - "+n(new Date(o.session_date).toLocaleDateString())+" "+n(new Date(o.start_time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"]),e(d).errors.attendance_session_id?(u(),m("p",ne,n(e(d).errors.attendance_session_id),1)):f("",!0)]),l("div",re,[s(e(w),{for:"reason"},{default:a(()=>t[8]||(t[8]=[r("Reason",-1)])),_:1,__:[8]}),s(e(ee),{id:"reason",modelValue:e(d).reason,"onUpdate:modelValue":t[1]||(t[1]=o=>e(d).reason=o),placeholder:"Explain your reason for absence"},null,8,["modelValue"]),e(d).errors.reason?(u(),m("p",de,n(e(d).errors.reason),1)):f("",!0)]),l("div",ie,[s(e(w),{for:"attachment"},{default:a(()=>t[9]||(t[9]=[r("Supporting Document (Optional)",-1)])),_:1,__:[9]}),s(e(X),{id:"attachment",type:"file",onChange:V,accept:".pdf,.jpg,.jpeg,.png"}),t[10]||(t[10]=l("p",{class:"text-xs text-muted-foreground"},"PDF, JPG, PNG up to 5MB.",-1)),_.value?(u(),m("p",ue," Selected: "+n(_.value.name)+" ("+n((_.value.size/1024/1024).toFixed(2))+" MB) ",1)):f("",!0),e(d).errors.attachment?(u(),m("p",me,n(e(d).errors.attachment),1)):f("",!0)]),s(e(y),{type:"submit",disabled:e(d).processing},{default:a(()=>[r(n(e(d).processing?"Submitting...":"Submit Request"),1)]),_:1},8,["disabled"])],32)]),_:1})]),_:1},8,["open"])]),l("div",fe,[s(e(c),null,{default:a(()=>[s(e(p),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[s(e(x),{class:"text-sm font-medium"},{default:a(()=>t[12]||(t[12]=[r("Total Requests",-1)])),_:1,__:[12]}),s(e(h),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),s(e(g),null,{default:a(()=>[l("div",_e,n(i.requests.total),1)]),_:1})]),_:1}),s(e(c),null,{default:a(()=>[s(e(p),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[s(e(x),{class:"text-sm font-medium"},{default:a(()=>t[13]||(t[13]=[r("Approved",-1)])),_:1,__:[13]}),s(e(D),{class:"h-4 w-4 text-green-600"})]),_:1}),s(e(g),null,{default:a(()=>[l("div",ce,n(i.requests.data.filter(o=>o.status==="approved").length),1)]),_:1})]),_:1}),s(e(c),null,{default:a(()=>[s(e(p),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[s(e(x),{class:"text-sm font-medium"},{default:a(()=>t[14]||(t[14]=[r("Pending",-1)])),_:1,__:[14]}),s(e(R),{class:"h-4 w-4 text-yellow-600"})]),_:1}),s(e(g),null,{default:a(()=>[l("div",pe,n(i.requests.data.filter(o=>o.status==="pending").length),1)]),_:1})]),_:1}),s(e(c),null,{default:a(()=>[s(e(p),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[s(e(x),{class:"text-sm font-medium"},{default:a(()=>t[15]||(t[15]=[r("Rejected",-1)])),_:1,__:[15]}),s(e(j),{class:"h-4 w-4 text-red-600"})]),_:1}),s(e(g),null,{default:a(()=>[l("div",xe,n(i.requests.data.filter(o=>o.status==="rejected").length),1)]),_:1})]),_:1})]),s(e(c),null,{default:a(()=>[s(e(p),null,{default:a(()=>[s(e(x),null,{default:a(()=>t[16]||(t[16]=[r("Your Requests",-1)])),_:1,__:[16]}),s(e(O),null,{default:a(()=>t[17]||(t[17]=[r("Track the status of your excuse requests",-1)])),_:1,__:[17]})]),_:1}),s(e(g),null,{default:a(()=>[l("div",ge,[(u(!0),m(b,null,S(i.requests.data,o=>(u(),m("div",{key:o.id,class:"border rounded-lg p-4 space-y-4"},[l("div",ve,[l("div",null,[l("h3",be,n(o.attendance_session.class.name),1),l("p",ye," Absence Date: "+n(new Date(o.attendance_session.session_date).toLocaleDateString())+" at "+n(new Date(o.attendance_session.start_time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})),1)]),l("div",we,[s(e(te),{variant:q(o.status)},{default:a(()=>[(u(),k(A(E(o.status)),{class:"w-3 h-3 mr-1"})),r(" "+n(o.status.charAt(0).toUpperCase()+o.status.slice(1)),1)]),_:2},1032,["variant"])])]),l("div",he,[l("div",null,[t[18]||(t[18]=l("p",{class:"text-sm font-medium text-muted-foreground"},"Reason",-1)),l("p",$e,n(o.reason),1)]),l("div",null,[t[19]||(t[19]=l("p",{class:"text-sm font-medium text-muted-foreground"},"Submitted On",-1)),l("p",Se,n(new Date(o.submitted_at).toLocaleString()),1)]),o.attachment_path?(u(),m("div",ke,[t[20]||(t[20]=l("p",{class:"text-sm font-medium text-muted-foreground"},"Attachment",-1)),l("a",{href:`/storage/${o.attachment_path}`,target:"_blank",class:"text-sm text-blue-600 hover:underline"},"View Document",8,Ce)])):f("",!0)]),o.status!=="pending"?(u(),m("div",De,[l("div",null,[t[21]||(t[21]=l("p",{class:"text-sm font-medium text-muted-foreground"},"Reviewed On",-1)),l("p",Re,n(o.reviewed_at?new Date(o.reviewed_at).toLocaleString():"N/A"),1)]),o.review_notes?(u(),m("div",je,[t[22]||(t[22]=l("p",{class:"text-sm font-medium text-muted-foreground"},"Comments",-1)),l("p",Fe,n(o.review_notes),1)])):f("",!0)])):f("",!0)]))),128)),i.requests.data.length===0?(u(),m("div",qe,[s(e(h),{class:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),t[24]||(t[24]=l("h3",{class:"text-lg font-medium mb-2"},"No excuse requests",-1)),t[25]||(t[25]=l("p",{class:"text-muted-foreground mb-4"},"You haven't submitted any excuse requests yet.",-1)),s(e(y),{onClick:t[3]||(t[3]=o=>v.value=!0)},{default:a(()=>[s(e(C),{class:"mr-2 h-4 w-4"}),t[23]||(t[23]=r(" Submit Your First Request ",-1))]),_:1,__:[23]})])):f("",!0)])]),_:1})]),_:1})])]),_:1})],64))}});export{We as default};
