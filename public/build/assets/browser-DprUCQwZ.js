import{P as Ye,c as fe,a as Ce,b as Bn,_ as te}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CGIYOqcj.js";import{C as Pt,I as In}from"./vue-qrcode-reader-VKk38FVR.js";import{_ as X,a as ee,b as we,c as xe}from"./CardTitle.vue_vue_type_script_setup_true_lang-FXh4yG6b.js";import{_ as W}from"./index-DpPOakUB.js";import{X as Rn,a as Me,b as Ne,B as tt,c as Tn}from"./AppLayout.vue_vue_type_script_setup_true_lang-CQKvJ_Ct.js";import{d as ae,H as fn,r as Q,j as G,o as T,w as m,I as ie,e as s,c as pe,s as mn,b as f,A as gn,k as O,y as Mn,p as Nn,a as H,n as Ke,J as Ge,C as Pn,K as An,f as u,i as k,t as R,F as Ue,g as Ve,L as Dn}from"./app-OXmU166Q.js";import{u as Ln,c as qn,a as Fn,P as Un,b as Vn,d as $n,G as At}from"./users-CgcVcNzr.js";import{u as We,a as zn,r as Ze}from"./useForwardExpose-Dn3oH0KL.js";import{R as On}from"./RovingFocusGroup-BlJuKAAH.js";import{R as jn}from"./RovingFocusItem-DdWoxizt.js";import{_ as Hn}from"./Textarea.vue_vue_type_script_setup_true_lang-DwZdkigF.js";import{_ as nt}from"./Input.vue_vue_type_script_setup_true_lang-B7F0P19X.js";import{_ as $e}from"./Label.vue_vue_type_script_setup_true_lang-B0_ysysQ.js";import{Q as ze}from"./qr-code-Bs10IxCn.js";import{Z as Jn}from"./zap-D_-B-eka.js";import{U as Pe}from"./user-DxFFOcnH.js";import{C as Oe}from"./circle-alert-CtovYjxa.js";import{C as he}from"./circle-check-big-C21okGWW.js";import{H as Dt}from"./hash-cC4QOznq.js";import{C as je}from"./calendar-N-OzfFB-.js";const[Tt,Qn]=qn("TabsRoot");var Kn=ae({__name:"TabsRoot",props:{defaultValue:{type:null,required:!1},orientation:{type:String,required:!1,default:"horizontal"},dir:{type:String,required:!1},activationMode:{type:String,required:!1,default:"automatic"},modelValue:{type:null,required:!1},unmountOnHide:{type:Boolean,required:!1,default:!0},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["update:modelValue"],setup(o,{emit:a}){const i=o,t=a,{orientation:e,unmountOnHide:n,dir:r}=fn(i),c=Ln(r);We();const d=zn(i,"modelValue",t,{defaultValue:i.defaultValue,passive:i.modelValue===void 0}),p=Q();return Qn({modelValue:d,changeModelValue:_=>{d.value=_},orientation:e,dir:c,unmountOnHide:n,activationMode:i.activationMode,baseId:Fn(void 0,"reka-tabs"),tabsList:p}),(_,M)=>(T(),G(s(Ye),{dir:s(c),"data-orientation":s(e),"as-child":_.asChild,as:_.as},{default:m(()=>[ie(_.$slots,"default",{modelValue:s(d)})]),_:3},8,["dir","data-orientation","as-child","as"]))}}),Yn=Kn;function hn(o,a){return`${o}-trigger-${a}`}function pn(o,a){return`${o}-content-${a}`}var Gn=ae({__name:"TabsContent",props:{value:{type:[String,Number],required:!0},forceMount:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(o){const a=o,{forwardRef:i}=We(),t=Tt(),e=pe(()=>hn(t.baseId,a.value)),n=pe(()=>pn(t.baseId,a.value)),r=pe(()=>a.value===t.modelValue.value),c=Q(r.value);return mn(()=>{requestAnimationFrame(()=>{c.value=!1})}),(d,p)=>(T(),G(s(Un),{present:d.forceMount||r.value,"force-mount":""},{default:m(({present:_})=>[f(s(Ye),{id:n.value,ref:s(i),"as-child":d.asChild,as:d.as,role:"tabpanel","data-state":r.value?"active":"inactive","data-orientation":s(t).orientation.value,"aria-labelledby":e.value,hidden:!_,tabindex:"0",style:gn({animationDuration:c.value?"0s":void 0})},{default:m(()=>[!s(t).unmountOnHide.value||_?ie(d.$slots,"default",{key:0}):O("v-if",!0)]),_:2},1032,["id","as-child","as","data-state","data-orientation","aria-labelledby","hidden","style"])]),_:3},8,["present"]))}}),Wn=Gn,Zn=ae({__name:"TabsList",props:{loop:{type:Boolean,required:!1,default:!0},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(o){const a=o,{loop:i}=fn(a),{forwardRef:t,currentElement:e}=We(),n=Tt();return n.tabsList=e,(r,c)=>(T(),G(s(On),{"as-child":"",orientation:s(n).orientation.value,dir:s(n).dir.value,loop:s(i)},{default:m(()=>[f(s(Ye),{ref:s(t),role:"tablist","as-child":r.asChild,as:r.as,"aria-orientation":s(n).orientation.value},{default:m(()=>[ie(r.$slots,"default")]),_:3},8,["as-child","as","aria-orientation"])]),_:3},8,["orientation","dir","loop"]))}}),Xn=Zn,es=ae({__name:"TabsTrigger",props:{value:{type:[String,Number],required:!0},disabled:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(o){const a=o,{forwardRef:i}=We(),t=Tt(),e=pe(()=>hn(t.baseId,a.value)),n=pe(()=>pn(t.baseId,a.value)),r=pe(()=>a.value===t.modelValue.value);return(c,d)=>(T(),G(s(jn),{"as-child":"",focusable:!c.disabled,active:r.value},{default:m(()=>[f(s(Ye),{id:e.value,ref:s(i),role:"tab",type:c.as==="button"?"button":void 0,as:c.as,"as-child":c.asChild,"aria-selected":r.value?"true":"false","aria-controls":n.value,"data-state":r.value?"active":"inactive",disabled:c.disabled,"data-disabled":c.disabled?"":void 0,"data-orientation":s(t).orientation.value,onMousedown:d[0]||(d[0]=Nn(p=>{!c.disabled&&p.ctrlKey===!1?s(t).changeModelValue(c.value):p.preventDefault()},["left"])),onKeydown:d[1]||(d[1]=Mn(p=>s(t).changeModelValue(c.value),["enter","space"])),onFocus:d[2]||(d[2]=()=>{const p=s(t).activationMode!=="manual";!r.value&&!c.disabled&&p&&s(t).changeModelValue(c.value)})},{default:m(()=>[ie(c.$slots,"default")]),_:3},8,["id","type","as","as-child","aria-selected","aria-controls","data-state","disabled","data-disabled","data-orientation"])]),_:3},8,["focusable","active"]))}}),ts=es;/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const so=fe("EyeIcon",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=fe("FileUpIcon",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=fe("FlashlightIcon",[["path",{d:"M18 6c0 2-2 2-2 4v10a2 2 0 0 1-2 2h-4a2 2 0 0 1-2-2V10c0-2-2-2-2-4V2h12z",key:"1orkel"}],["line",{x1:"6",x2:"18",y1:"6",y2:"6",key:"1z11jq"}],["line",{x1:"12",x2:"12",y1:"12",y2:"12",key:"1f4yc1"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=fe("PlayIcon",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=fe("RotateCwIcon",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ao=fe("ScanLineIcon",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=fe("SquareIcon",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=fe("SwitchCameraIcon",[["path",{d:"M11 19H4a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h5",key:"mtk2lu"}],["path",{d:"M13 5h7a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-5",key:"120jsl"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["path",{d:"m18 22-3-3 3-3",key:"kgdoj7"}],["path",{d:"m6 2 3 3-3 3",key:"1fnbkv"}]]),He=ae({__name:"Alert",props:{class:{},variant:{}},setup(o){const a=o;return(i,t)=>(T(),H("div",{"data-slot":"alert",class:Ke(s(Ce)(s(rs)({variant:i.variant}),a.class)),role:"alert"},[ie(i.$slots,"default")],2))}}),Je=ae({__name:"AlertDescription",props:{class:{}},setup(o){const a=o;return(i,t)=>(T(),H("div",{"data-slot":"alert-description",class:Ke(s(Ce)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",a.class))},[ie(i.$slots,"default")],2))}}),rs=Bn("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}}),os=ae({__name:"Tabs",props:{defaultValue:{},orientation:{},dir:{},activationMode:{},modelValue:{},unmountOnHide:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["update:modelValue"],setup(o,{emit:a}){const i=o,t=a,e=Ze(i,"class"),n=Vn(e,t);return(r,c)=>(T(),G(s(Yn),Ge({"data-slot":"tabs"},s(n),{class:s(Ce)("flex flex-col gap-2",i.class)}),{default:m(()=>[ie(r.$slots,"default")]),_:3},16,["class"]))}}),rt=ae({__name:"TabsContent",props:{value:{},forceMount:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(o){const a=o,i=Ze(a,"class");return(t,e)=>(T(),G(s(Wn),Ge({"data-slot":"tabs-content",class:s(Ce)("flex-1 outline-none",a.class)},s(i)),{default:m(()=>[ie(t.$slots,"default")]),_:3},16,["class"]))}}),ls=ae({__name:"TabsList",props:{loop:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(o){const a=o,i=Ze(a,"class");return(t,e)=>(T(),G(s(Xn),Ge({"data-slot":"tabs-list"},s(i),{class:s(Ce)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",a.class)}),{default:m(()=>[ie(t.$slots,"default")]),_:3},16,["class"]))}}),ot=ae({__name:"TabsTrigger",props:{value:{},disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(o){const a=o,i=Ze(a,"class"),t=$n(i);return(e,n)=>(T(),G(s(ts),Ge({"data-slot":"tabs-trigger"},s(t),{class:s(Ce)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a.class)}),{default:m(()=>[ie(e.$slots,"default")]),_:3},16,["class"]))}}),is={key:0,class:"fixed inset-0 z-50 bg-background/80 backdrop-blur-sm flex items-center justify-center p-4"},us={class:"bg-background border rounded-xl shadow-xl w-full max-w-6xl h-[95vh] flex flex-col overflow-hidden"},ds={class:"flex-shrink-0 border-b bg-gradient-to-r from-background to-muted/20"},cs={class:"px-6 py-4"},fs={class:"flex items-center justify-between"},ms={class:"flex items-center gap-3"},gs={class:"w-10 h-10 bg-primary rounded-lg flex items-center justify-center"},hs={class:"flex items-center gap-2"},ps={class:"flex-1 overflow-hidden"},vs={class:"flex-shrink-0 border-b bg-muted/30"},ys={class:"px-6"},_s={class:"grid grid-cols-1 xl:grid-cols-3 gap-6 h-full"},bs={class:"xl:col-span-2 flex flex-col"},ws={class:"bg-black rounded-xl overflow-hidden relative flex-1 flex items-center justify-center min-h-[400px]"},xs={key:1,class:"absolute inset-0 flex items-center justify-center bg-muted/50"},Ss={key:0,class:"space-y-4"},Cs={key:1,class:"space-y-4"},ks={key:2,class:"space-y-4"},Es={class:"text-sm text-muted-foreground mt-2"},Bs={class:"flex gap-2"},Is={key:2,class:"absolute inset-0 flex items-center justify-center bg-muted/50"},Rs={class:"space-y-4"},Ts={key:3,class:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-3"},Ms={class:"mt-4"},Ns={class:"flex items-center gap-3"},Ps={class:"w-8 h-8 bg-blue-100 dark:bg-blue-800 rounded-full flex items-center justify-center"},As={class:"xl:col-span-1 space-y-6"},Ds={key:0,class:"animate-fade-in"},Ls={class:"flex items-center gap-2 mb-3"},qs={class:"text-sm font-medium text-muted-foreground"},Fs={class:"space-y-2 max-h-64 overflow-y-auto"},Us={class:"flex items-center gap-2"},Vs={class:"flex-1 min-w-0"},$s={class:"text-sm font-medium truncate"},zs={class:"flex items-center gap-2 mt-1"},Os={key:0,class:"text-center py-2"},js={class:"text-xs text-muted-foreground"},Hs={key:1,class:"animate-fade-in"},Js={class:"flex items-center gap-2 mb-3"},Qs={class:"flex items-start gap-3"},Ks={class:"flex-1 min-w-0 space-y-2"},Ys={class:"flex items-start gap-2"},Gs={class:"font-semibold text-sm leading-tight truncate"},Ws={class:"space-y-1 text-xs"},Zs={class:"flex items-center gap-2"},Xs={class:"font-mono"},ea={class:"flex items-center gap-2"},ta={class:"flex items-center gap-2"},na={class:"flex items-center gap-2"},sa={key:2,class:"flex-1"},aa={class:"flex items-center gap-2 mb-3"},ra={class:"space-y-2 max-h-64 overflow-y-auto"},oa={class:"flex items-center gap-2"},la={class:"flex-1 min-w-0"},ia={class:"text-sm font-medium truncate"},ua={class:"flex items-center gap-2 mt-1"},da={class:"text-xs text-muted-foreground truncate"},ca={key:3,class:"text-center py-8 h-full flex flex-col items-center justify-center border-2 border-dashed rounded-xl border-muted"},fa={class:"mx-auto mb-3 w-12 h-12 bg-muted rounded-full flex items-center justify-center"},ma={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 h-full"},ga={class:"space-y-6"},ha={class:"mx-auto mb-4 w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center"},pa={class:"space-y-2"},va={key:0,class:"text-sm text-destructive"},ya={class:"space-y-2"},_a={key:0,class:"text-sm text-destructive"},ba={class:"space-y-2"},wa={class:"space-y-6"},xa={key:0,class:"animate-fade-in"},Sa={class:"flex items-center gap-2 mb-3"},Ca={class:"flex items-start gap-3"},ka={class:"flex-1 min-w-0 space-y-2"},Ea={class:"flex items-start gap-2"},Ba={class:"font-semibold text-sm leading-tight truncate"},Ia={class:"space-y-1 text-xs"},Ra={class:"flex items-center gap-2"},Ta={class:"font-mono"},Ma={class:"flex items-center gap-2"},Na={class:"flex items-center gap-2"},Pa={class:"flex items-center gap-2"},Aa={class:"max-h-80 overflow-y-auto"},Da={class:"flex items-center gap-3"},La={class:"flex-1 min-w-0"},qa={class:"text-sm font-medium truncate"},Fa={class:"flex items-center gap-2 mt-1"},Ua={class:"text-xs text-muted-foreground font-mono"},Va={class:"text-right shrink-0"},$a={class:"text-xs text-muted-foreground capitalize"},za={key:2,class:"text-center py-12 h-full flex flex-col items-center justify-center border-2 border-dashed rounded-xl border-muted"},Oa={class:"mx-auto mb-3 w-12 h-12 bg-muted rounded-full flex items-center justify-center"},ja={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 h-full"},Ha={class:"space-y-6"},Ja={class:"mx-auto mb-4 w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center"},Qa={class:"space-y-2"},Ka={class:"flex gap-2"},Ya={key:0,class:"space-y-2"},Ga={class:"flex items-center justify-between text-sm"},Wa={class:"font-medium"},Za={class:"w-full bg-muted rounded-full h-2 overflow-hidden"},Xa={class:"space-y-6"},er={class:"max-h-[600px] overflow-y-auto"},tr={class:"flex items-start gap-3"},nr={class:"flex-shrink-0 w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center"},sr={class:"text-xs font-semibold text-primary"},ar={class:"flex-1 min-w-0 space-y-1"},rr={class:"text-sm font-medium truncate"},or={class:"flex flex-wrap items-center gap-2 text-xs"},lr={key:1,class:"text-muted-foreground"},ir={key:2,class:"text-muted-foreground"},ur={key:1,class:"text-center py-12 h-full flex flex-col items-center justify-center border-2 border-dashed rounded-xl border-muted"},dr={class:"mx-auto mb-3 w-12 h-12 bg-muted rounded-full flex items-center justify-center"},cr={key:0,class:"absolute inset-0 bg-background/80 backdrop-blur-sm flex items-center justify-center z-20"},fr={key:1,class:"flex-shrink-0 p-4 border-t bg-background animate-fade-in"},mr={class:"max-w-4xl mx-auto"},gr=ae({__name:"QrScanner",props:{show:{type:Boolean},sessionId:{}},emits:["close","scanSuccess","batchScanSuccess"],setup(o,{emit:a}){const i=o,t=a,e=Q("off"),n=Q(!1),r=Q(""),c=Q(!1),d=Q(null),p=Q("loading"),_=Q(""),M=Q(""),w=Q("camera"),v=Q([]),B=Q(!1),N=Q([]),K=Q(null),q=Q(null),F=Q(0),E=Q([]),P=Q(""),j=Q(""),b=Q(!1),C=Q(""),x=Q(""),y=Q({});Q(""),Q(""),Q("");const D={name:h=>h.trim()?h.length<2?"Name must be at least 2 characters":/^[a-zA-Z\s.'-]+$/.test(h)?"":"Name can only contain letters, spaces, and basic punctuation":"Name is required",course:h=>h.trim()?h.length<2?"Course must be at least 2 characters":/^(BS|Bachelor|BSCS|BSIT|BSEE|BSME|BSBA)/i.test(h)?"":"Please enter a valid course (e.g., BSCS, BSIT)":"Course is required"},I=(h,l)=>{const V=D[h];V&&(y.value[h]=V(l))},A=()=>{const h={name:C.value,course:x.value};return Object.entries(h).forEach(([l,V])=>{I(l,V)}),!Object.values(y.value).some(l=>l)},S=pe(()=>window.isSecureContext);mn(()=>{_.value=`Secure: ${window.isSecureContext}, Protocol: ${window.location.protocol}, Host: ${window.location.hostname}`,console.log("Camera Debug Info:",_.value),S.value||(w.value="manual",r.value="Camera requires HTTPS. Using manual input mode.");const h=localStorage.getItem("qrScanHistory");if(h)try{v.value=JSON.parse(h).slice(0,10)}catch(l){console.error("Failed to load scan history:",l)}});const L=h=>{v.value.unshift(h),v.value.length>10&&(v.value=v.value.slice(0,10)),localStorage.setItem("qrScanHistory",JSON.stringify(v.value))};Pn(()=>i.show,h=>{h&&w.value==="camera"&&S.value?(e.value="auto",r.value="",p.value="loading",B.value=!0):(e.value="off",B.value=!1)},{immediate:!0});const re=()=>{console.log("Camera initialized successfully"),p.value="ready",r.value=""},me=()=>{console.log("Camera turned off"),p.value="loading"},Xe=h=>{console.error("Camera error details:",h),p.value="error",h?.name==="NotAllowedError"?r.value="Camera access denied. Please allow camera permissions.":h?.name==="NotFoundError"?r.value="No camera found on this device.":h?.name==="NotSupportedError"||h?.message?.includes("secure context")?(r.value="Camera not supported in HTTP context. Switch to manual mode.",p.value="unsupported"):r.value=`Camera error: ${h?.message||"Unknown error"}`},De=async h=>{if(c.value||!h.length)return;const V=h[0]?.rawValue;try{c.value=!0,r.value="",y.value={};let g,U="json";if(V)try{g=JSON.parse(V),console.log("QR Code parsed successfully (JSON):",g),U="json"}catch($){console.log("QR is not JSON, trying alternative formats:",$);const z=Ee(V);if(z)g=z.student,U=z.format;else{r.value="QR code format not recognized. Please use manual input.";return}}else g=Le(),U="mock";const Y=ke(g);if(Y){r.value=Y;return}if(g.year&&(g.year=ue(g.year)),g.needsLookup)try{const $=await ge(g.name,g.course);if($)g={...g,student_id:$.student_id,year:$.year,course:$.course,section:$.section,needsLookup:!1},console.log("Student found in database:",g);else{r.value=`Student "${g.name}" with course "${g.course}" not found in this class or database. Please verify the student is enrolled.`;return}}catch($){console.warn("Failed to lookup student:",$),r.value="Database lookup failed. Please try again.";return}g={...g,id:g.id||`scan-${Date.now()}`,timestamp:new Date().toISOString()},await new Promise($=>setTimeout($,800));const J={student:g,rawData:V||"mock",format:U};d.value=g,L(J),N.value.findIndex($=>$.student_id===g.student_id)===-1&&N.value.push(g),r.value=""}catch(g){console.error("QR Scan error:",g),r.value="Scan processing error"}finally{c.value=!1}},ue=h=>{const l=h.toLowerCase().trim();return{1:"1st",first:"1st","1st year":"1st","1st-year":"1st",year1:"1st","year 1":"1st",2:"2nd",second:"2nd","2nd year":"2nd","2nd-year":"2nd",year2:"2nd","year 2":"2nd",3:"3rd",third:"3rd","3rd year":"3rd","3rd-year":"3rd",year3:"3rd","year 3":"3rd",4:"4th",fourth:"4th","4th year":"4th","4th-year":"4th",year4:"4th","year 4":"4th",5:"5th",fifth:"5th","5th year":"5th","5th-year":"5th",year5:"5th","year 5":"5th"}[l]||h},ke=h=>!h.needsLookup&&(!h.student_id||typeof h.student_id!="string")?"Invalid or missing student ID":!h.name||typeof h.name!="string"?"Invalid or missing student name":h.year&&typeof h.year!="string"?"Invalid year format":h.course&&typeof h.course!="string"?"Invalid course format":h.section&&typeof h.section!="string"?"Invalid section format":h.year&&h.year.trim()!==""&&!/^(1st|2nd|3rd|4th|5th)$/.test(ue(h.year))?"Invalid year level. Must be 1st, 2nd, 3rd, 4th, or 5th year":null,_e=()=>{const h=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");return h||console.warn("CSRF token not found in meta tag"),h||""},ge=async(h,l)=>{try{const V=`${h},${l}`;if(i.sessionId){console.log("Making QR scan request:",{sessionId:i.sessionId,qrData:V});const g=await fetch(`/teacher/attendance/${i.sessionId}/qr-scan`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":_e(),"X-Requested-With":"XMLHttpRequest"},credentials:"same-origin",body:JSON.stringify({qr_data:V})});if(console.log("QR scan response status:",g.status),g.status===419)throw new Error("CSRF token mismatch. Please refresh the page and try again.");if(g.ok){const U=await g.json();if(console.log("QR scan response data:",U),U.success)return console.log("Student marked as present:",U.student),{id:U.student.id?.toString()||`db-${Date.now()}`,student_id:U.student.student_id,name:U.student.name,year:U.student.year||"",course:U.student.course||l,section:U.student.section||""};throw new Error(U.message||"Student not found")}else{let U=`Request failed with status ${g.status}`;try{U=(await g.json()).message||U}catch{}throw new Error(U)}}else throw new Error("No attendance session available")}catch(V){throw console.error("Student lookup failed:",V),V}},Ee=h=>{const l=h.trim();if(console.log("ðŸ” Raw QR Data:",JSON.stringify(h)),console.log("ðŸ” Trimmed QR Data:",JSON.stringify(l)),console.log("ðŸ” Checking simple fallback - has comma:",l.includes(",")),l.includes(",")){const $=l.split(",");if(console.log("ðŸ” Simple split result:",$),console.log("ðŸ” Simple parts length:",$.length),$.length>=2){const z=$[0].trim(),oe=$[1].trim();if(console.log("ðŸ” Simple parser - Name after trim:",JSON.stringify(z)),console.log("ðŸ” Simple parser - Course after trim:",JSON.stringify(oe)),console.log("ðŸ” Simple parser - Name check:",!!z),console.log("ðŸ” Simple parser - Course check:",!!oe),z&&oe)return console.log("âœ… Simple fallback parser SUCCESS - Name:",z,"Course:",oe),{student:{id:`simple-${Date.now()}`,student_id:"",name:z,year:"",course:oe,section:"",timestamp:new Date().toISOString(),needsLookup:!0},format:"name-course"};console.log("âŒ Simple fallback failed - empty name or course")}else console.log("âŒ Simple fallback failed - not enough parts")}else console.log("âŒ Simple fallback failed - no comma found");const V=l.split(",").map($=>$.trim()).filter($=>$.length>0);if(console.log("ðŸ” Split parts:",V),V.length>=2){const $=V[0],z=V[1];if(console.log("ðŸ” Student Name:",JSON.stringify($)),console.log("ðŸ” Course:",JSON.stringify(z)),$.length>0&&z.length>0){console.log("ðŸ” Course validation - checking:",z);const Fe=/^(BS|BSCS|BSIT|BSEE|BSME|BSBA|Bachelor|CS|IT|EE|ME|BA)/i.test(z);if(console.log("ðŸ” Course pattern test result:",Fe),Fe)return console.log("âœ… QR Code detected - Name:",$,"Course:",z),{student:{id:`name-course-${Date.now()}`,student_id:"",name:$,year:"",course:z,section:"",timestamp:new Date().toISOString(),needsLookup:!0},format:"name-course"};console.log("âŒ Course validation failed for:",z)}else console.log("âŒ Name or course is empty - Name:",$,"Course:",z)}else console.log("âŒ Not enough parts after split. Need at least 2, got:",V.length);const g=l.match(/^([^,]+),\s*(BSCS|BSIT|BSEE|BSME|BSBA|BS[A-Z]{2,4}|Bachelor[^,]*),*\s*$/i);if(g){const $=g[1].trim(),z=g[2].trim();return console.log("QR Code detected (regex) - Name:",$,"Course:",z),{student:{id:`regex-${Date.now()}`,student_id:"",name:$,year:"",course:z,section:"",timestamp:new Date().toISOString(),needsLookup:!0},format:"name-course"}}const U=l.match(/^([^,]+),([^,]+),([^,]*),([^,]*),([^,]*)$/);if(U)return{student:{id:`csv-${Date.now()}`,student_id:U[1].trim(),name:U[2].trim(),year:ue(U[3].trim())||"",course:U[4].trim()||"",section:U[5].trim()||"",timestamp:new Date().toISOString()},format:"csv"};try{const $=new URL(l),z=new URLSearchParams($.search);if(z.get("student_id")||z.get("name"))return{student:{id:`url-${Date.now()}`,student_id:z.get("student_id")||"",name:z.get("name")||"",year:ue(z.get("year")||""),course:z.get("course")||"",section:z.get("section")||"",timestamp:new Date().toISOString()},format:"url"}}catch{}const Y=/(\w+)[:=]\s*([^;|]+)/g,J={};let Z;for(;(Z=Y.exec(l))!==null;){const[,$,z]=Z;J[$.toLowerCase()]=z.trim()}return J.student_id||J.name?{student:{id:`kv-${Date.now()}`,student_id:J.student_id||J.id||"",name:J.name||J.student_name||"",year:ue(J.year||J.yr||J.year_level||""),course:J.course||J.program||"",section:J.section||J.sec||"",timestamp:new Date().toISOString()},format:"keyvalue"}:(console.log("âŒ No parsing method succeeded for QR data:",JSON.stringify(l)),null)},Le=()=>{const h=["1st","2nd","3rd","4th","5th"],l=["BSCS","BSIT","BSEE","BSME","BSBA"];return{id:"dev-"+Date.now(),student_id:"STU-"+Math.random().toString(36).substr(2,9).toUpperCase(),name:"Demo Student "+Math.floor(Math.random()*100),year:h[Math.floor(Math.random()*h.length)],course:l[Math.floor(Math.random()*l.length)],section:String.fromCharCode(65+Math.floor(Math.random()*3)),timestamp:new Date().toISOString()}},Be=async()=>{if(!M.value.trim()){r.value="Please enter QR code data";return}try{c.value=!0,r.value="",y.value={};const h=M.value.trim();let l,V="name-course";const g=h.split(",").map(Y=>Y.trim()).filter(Y=>Y.length>0);if(g.length>=2){const Y=g[0],J=g[1];console.log("Manual QR processing - Name:",Y,"Course:",J);const Z=await ge(Y,J);if(Z)l={...Z,timestamp:new Date().toISOString()};else{r.value=`Student "${Y}" with course "${J}" not found`;return}}else try{const Y=JSON.parse(h);if(Y.name&&Y.course){const J=await ge(Y.name,Y.course);if(J)l={...J,timestamp:new Date().toISOString()},V="json";else{r.value=`Student "${Y.name}" not found`;return}}else{r.value='Invalid format. Use "Name,Course" or valid JSON with name and course';return}}catch{r.value='Invalid format. Please use "Name,Course" format (e.g., "Juan Dela Cruz,BSCS")';return}const U={student:l,rawData:h,format:V};d.value=l,L(U),t("scanSuccess",l),M.value="",r.value=""}catch(h){console.error("Manual scan error:",h),r.value=h instanceof Error?h.message:"Student lookup failed"}finally{c.value=!1}},qe=async()=>{if(!A()){r.value="Please fix the form errors before submitting";return}try{c.value=!0,r.value="",y.value={};const h=C.value.trim(),l=x.value.trim(),V=await ge(h,l);if(V){const g={...V,timestamp:new Date().toISOString()},U={student:g,rawData:`${h},${l}`,format:"name-course"};d.value=g,L(U),t("scanSuccess",g),C.value="",x.value="",y.value={},r.value=""}else r.value=`Student "${h}" with course "${l}" not found in database`}catch(h){console.error("Manual form error:",h),r.value=h instanceof Error?h.message:"Student lookup failed"}finally{c.value=!1}},ne=()=>{const h=Le(),l={student:h,rawData:"quick_test",format:"mock"};d.value=h,L(l),t("scanSuccess",h)},se=()=>{e.value==="auto"||e.value==="front"?e.value="rear":e.value="front"},de=()=>{n.value=!n.value},Ie=()=>{e.value="off",B.value=!1,N.value=[],t("close")},Nt=()=>{B.value?(e.value="off",B.value=!1,N.value.length>0&&(t("batchScanSuccess",[...N.value]),N.value=[])):w.value==="camera"&&S.value&&(e.value="auto",r.value="",p.value="loading",B.value=!0)},wn=()=>{if(!S.value){r.value="Camera requires HTTPS. Please use manual mode or enable HTTPS.";return}w.value="camera",e.value="auto",r.value="",y.value={}},et=()=>{w.value="manual",e.value="off",r.value=""},xn=()=>{w.value="upload",e.value="off",r.value="",j.value=""},Sn=h=>{const V=h.target.files?.[0];V&&(q.value=V,j.value="",P.value="",Cn(V))},Cn=async h=>{if(!h)return;if(!["text/csv","application/vnd.ms-excel","text/plain"].includes(h.type)&&!h.name.endsWith(".csv")){j.value="Please upload a CSV file";return}try{b.value=!0,j.value="",E.value=[],F.value=0;const g=(await h.text()).split(`
`).filter(Z=>Z.trim());if(g.length===0){j.value="File is empty",b.value=!1;return}const U=[];let Y=!1;const J=g[0].toLowerCase();(J.includes("student_id")||J.includes("name")||J.includes("id"))&&(Y=!0,g.shift());for(let Z=0;Z<g.length;Z++){const $=g[Z].trim();if(!$)continue;const z=$.split(",").map(Fe=>Fe.trim().replace(/^["']|["']$/g,""));if(z.length<2){console.warn(`Skipping invalid line ${Z+1}: ${$}`);continue}const oe={id:`upload-${Date.now()}-${Z}`,student_id:z[0]||"",name:z[1]||"",year:z[2]?ue(z[2]):"",course:z[3]||"",section:z[4]||"",timestamp:new Date().toISOString()};oe.student_id&&oe.name&&U.push(oe),F.value=Math.round((Z+1)/g.length*100)}if(U.length===0){j.value="No valid student data found in file",b.value=!1;return}E.value=U,P.value=`Successfully parsed ${U.length} student(s) from file`,F.value=100}catch(V){console.error("File upload error:",V),j.value=`Failed to process file: ${V}`}finally{b.value=!1}},kn=async()=>{if(E.value.length===0){j.value="No students to save";return}try{c.value=!0,j.value="";let h=0,l=0;for(const V of E.value)L({student:V,rawData:"bulk_upload",format:"file"}),t("scanSuccess",V),h++,await new Promise(U=>setTimeout(U,100));P.value=`Successfully added ${h} student(s)`,setTimeout(()=>{E.value=[],q.value=null,F.value=0,K.value&&(K.value.value="")},2e3)}catch(h){console.error("Save students error:",h),j.value="Failed to save students. Please try again."}finally{c.value=!1}},En=()=>{switch(e.value){case"front":return"Front Camera";case"rear":return"Rear Camera";case"off":return"Camera Off";default:return"Auto Camera"}},Re=h=>h.split(" ").map(l=>l[0]).join("").toUpperCase().substring(0,2),Te=h=>new Date(h).toLocaleTimeString(),be=h=>({"1st":"default","2nd":"secondary","3rd":"outline","4th":"default","5th":"secondary"})[h]||"outline";return(h,l)=>{const V=An("Clock");return h.show?(T(),H("div",is,[u("div",us,[u("div",ds,[u("div",cs,[u("div",fs,[u("div",ms,[u("div",gs,[f(s(ze),{class:"h-6 w-6 text-primary-foreground"})]),l[6]||(l[6]=u("div",null,[u("h2",{class:"text-2xl font-bold tracking-tight"},"Student Attendance Scanner"),u("p",{class:"text-sm text-muted-foreground"}," Scan name+course QR codes to automatically mark students as present ")],-1))]),u("div",hs,[f(s(W),{variant:"secondary",class:"text-xs"},{default:m(()=>[k(R(N.value.length)+" pending â€¢ "+R(v.value.length)+" total ",1)]),_:1}),f(s(te),{variant:"outline",size:"sm",onClick:ne},{default:m(()=>[f(s(Jn),{class:"h-4 w-4 mr-2"}),l[7]||(l[7]=k(" Test Scan ",-1))]),_:1,__:[7]}),w.value==="camera"?(T(),G(s(te),{key:0,variant:B.value?"destructive":"default",size:"sm",onClick:Nt,disabled:p.value==="error"||p.value==="unsupported"},{default:m(()=>[B.value?O("",!0):(T(),G(s(Lt),{key:0,class:"h-4 w-4 mr-2"})),B.value?(T(),G(s(ss),{key:1,class:"h-4 w-4 mr-2"})):O("",!0),k(" "+R(B.value?"Stop Scanning":"Start Scanning"),1)]),_:1},8,["variant","disabled"])):O("",!0),f(s(te),{variant:"ghost",size:"icon",onClick:Ie},{default:m(()=>[f(s(Rn),{class:"h-5 w-5"})]),_:1})])])])]),u("div",ps,[f(s(os),{value:w.value,class:"h-full flex flex-col"},{default:m(()=>[u("div",vs,[u("div",ys,[f(s(ls),{class:"w-full grid grid-cols-3 bg-transparent h-auto p-0"},{default:m(()=>[f(s(ot),{value:"camera",onClick:wn,class:"rounded-none border-b-2 border-transparent data-[state=active]:border-primary data-[state=active]:bg-transparent py-3"},{default:m(()=>[f(s(Pt),{class:"h-4 w-4 mr-2"}),l[9]||(l[9]=k(" QR Scan (Auto Present) ",-1)),S.value?O("",!0):(T(),G(s(W),{key:0,variant:"destructive",class:"ml-2 h-4 px-1 text-xs"},{default:m(()=>l[8]||(l[8]=[k(" HTTPS ",-1)])),_:1,__:[8]}))]),_:1,__:[9]}),f(s(ot),{value:"manual",onClick:et,class:"rounded-none border-b-2 border-transparent data-[state=active]:border-primary data-[state=active]:bg-transparent py-3"},{default:m(()=>[f(s(Pe),{class:"h-4 w-4 mr-2"}),l[10]||(l[10]=k(" Manual Lookup ",-1))]),_:1,__:[10]}),f(s(ot),{value:"upload",onClick:xn,class:"rounded-none border-b-2 border-transparent data-[state=active]:border-primary data-[state=active]:bg-transparent py-3"},{default:m(()=>[f(s(st),{class:"h-4 w-4 mr-2"}),l[11]||(l[11]=k(" File Upload ",-1))]),_:1,__:[11]})]),_:1})])]),f(s(rt),{value:"camera",class:"flex-1 m-0 p-6 overflow-auto data-[state=inactive]:hidden"},{default:m(()=>[u("div",_s,[u("div",bs,[u("div",ws,[e.value!=="off"&&S.value?(T(),G(s(In),{key:0,camera:e.value,torch:n.value,onDetect:De,onError:Xe,onCameraOn:re,onCameraOff:me,class:"w-full h-full object-contain"},{default:m(()=>l[12]||(l[12]=[u("div",{class:"absolute inset-0 flex items-center justify-center pointer-events-none"},[u("div",{class:"relative"},[u("div",{class:"w-64 h-64 relative"},[u("div",{class:"absolute -top-2 -left-2 w-12 h-12 border-t-4 border-l-4 border-primary rounded-tl-lg"}),u("div",{class:"absolute -top-2 -right-2 w-12 h-12 border-t-4 border-r-4 border-primary rounded-tr-lg"}),u("div",{class:"absolute -bottom-2 -left-2 w-12 h-12 border-b-4 border-l-4 border-primary rounded-bl-lg"}),u("div",{class:"absolute -bottom-2 -right-2 w-12 h-12 border-b-4 border-r-4 border-primary rounded-br-lg"}),u("div",{class:"absolute top-0 left-0 right-0 h-1 bg-primary shadow-[0_0_20px_rgba(var(--primary),0.8)] animate-scan"})])])],-1)])),_:1,__:[12]},8,["camera","torch"])):O("",!0),p.value!=="ready"&&B.value?(T(),H("div",xs,[f(s(X),{class:"max-w-sm w-full mx-4"},{default:m(()=>[f(s(ee),{class:"p-6 text-center"},{default:m(()=>[p.value==="loading"?(T(),H("div",Ss,[f(s(at),{class:"h-12 w-12 animate-spin mx-auto text-primary"}),l[13]||(l[13]=u("div",null,[u("p",{class:"font-semibold text-lg"},"Initializing Camera"),u("p",{class:"text-sm text-muted-foreground"},"Please wait...")],-1))])):p.value==="unsupported"?(T(),H("div",Cs,[f(s(Oe),{class:"h-12 w-12 mx-auto text-yellow-500"}),l[15]||(l[15]=u("div",null,[u("p",{class:"font-semibold text-lg"},"Camera Not Available"),u("p",{class:"text-sm text-muted-foreground mt-2"}," Camera requires HTTPS connection for security. ")],-1)),f(s(te),{onClick:et,class:"w-full"},{default:m(()=>[f(s(Pe),{class:"h-4 w-4 mr-2"}),l[14]||(l[14]=k(" Switch to Manual Mode ",-1))]),_:1,__:[14]})])):p.value==="error"?(T(),H("div",ks,[f(s(Oe),{class:"h-12 w-12 mx-auto text-destructive"}),u("div",null,[l[16]||(l[16]=u("p",{class:"font-semibold text-lg"},"Camera Error",-1)),u("p",Es,R(r.value),1)]),u("div",Bs,[f(s(te),{onClick:l[0]||(l[0]=g=>e.value="auto"),variant:"outline",class:"flex-1"},{default:m(()=>[f(s(at),{class:"h-4 w-4 mr-2"}),l[17]||(l[17]=k(" Retry ",-1))]),_:1,__:[17]}),f(s(te),{onClick:et,class:"flex-1"},{default:m(()=>l[18]||(l[18]=[k(" Manual Mode ",-1)])),_:1,__:[18]})])])):O("",!0)]),_:1})]),_:1})])):O("",!0),!B.value&&p.value!=="ready"?(T(),H("div",Is,[f(s(X),{class:"max-w-sm w-full mx-4"},{default:m(()=>[f(s(ee),{class:"p-6 text-center"},{default:m(()=>[u("div",Rs,[f(s(Pt),{class:"h-12 w-12 mx-auto text-muted-foreground"}),l[20]||(l[20]=u("div",null,[u("p",{class:"font-semibold text-lg"},"Camera Stopped"),u("p",{class:"text-sm text-muted-foreground"},'Click "Start Scanning" to begin scanning QR codes')],-1)),f(s(te),{onClick:Nt,class:"w-full"},{default:m(()=>[f(s(Lt),{class:"h-4 w-4 mr-2"}),l[19]||(l[19]=k(" Start Scanning ",-1))]),_:1,__:[19]})])]),_:1})]),_:1})])):O("",!0),p.value==="ready"&&B.value?(T(),H("div",Ts,[f(s(te),{variant:"secondary",size:"lg",onClick:se,title:En(),class:"rounded-full shadow-xl backdrop-blur-sm bg-background/80"},{default:m(()=>[f(s(as),{class:"h-5 w-5 mr-2"}),l[21]||(l[21]=k(" Switch ",-1))]),_:1,__:[21]},8,["title"]),f(s(te),{variant:n.value?"default":"secondary",size:"lg",onClick:de,title:"Toggle flashlight",class:"rounded-full shadow-xl backdrop-blur-sm bg-background/80"},{default:m(()=>[f(s(ns),{class:"h-5 w-5 mr-2",fill:n.value?"currentColor":"none"},null,8,["fill"]),l[22]||(l[22]=k(" Flash ",-1))]),_:1,__:[22]},8,["variant"])])):O("",!0)]),u("div",Ms,[f(s(X),{class:"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200 dark:from-blue-950/20 dark:to-indigo-950/20"},{default:m(()=>[f(s(ee),{class:"p-4"},{default:m(()=>[u("div",Ns,[u("div",Ps,[f(s(ze),{class:"h-4 w-4 text-blue-600 dark:text-blue-400"})]),l[23]||(l[23]=u("div",null,[u("p",{class:"text-sm font-medium text-blue-900 dark:text-blue-100"},"How to scan"),u("p",{class:"text-xs text-blue-700 dark:text-blue-300"},'Scan QR codes containing student name and course (e.g., "EJ FAYE A. DULAY,BSCS,,"). Students will be added to pending list. Click "Stop Scanning" to mark all scanned students as present.')],-1))])]),_:1})]),_:1})])]),u("div",As,[N.value.length>0?(T(),H("div",Ds,[u("div",Ls,[f(V,{class:"h-4 w-4 text-orange-500"}),u("p",qs,"Pending Scans ("+R(N.value.length)+")",1),f(s(W),{variant:"outline",class:"ml-auto text-xs bg-orange-50 text-orange-700 border-orange-200"},{default:m(()=>l[24]||(l[24]=[k(" Will be marked present when stopped ",-1)])),_:1,__:[24]})]),u("div",Fs,[(T(!0),H(Ue,null,Ve(N.value.slice(0,5),(g,U)=>(T(),G(s(X),{key:g.id,class:"group hover:border-orange-300 transition-colors border-orange-200 bg-orange-50/50 dark:bg-orange-950/20"},{default:m(()=>[f(s(ee),{class:"p-3"},{default:m(()=>[u("div",Us,[f(s(Me),{class:"h-8 w-8 shrink-0"},{default:m(()=>[f(s(Ne),{class:"text-xs bg-orange-100 text-orange-700"},{default:m(()=>[k(R(Re(g.name)),1)]),_:2},1024)]),_:2},1024),u("div",Vs,[u("p",$s,R(g.name),1),u("div",zs,[f(s(W),{variant:"outline",class:"text-xs font-mono"},{default:m(()=>[k(R(g.student_id),1)]),_:2},1024),g.year?(T(),G(s(W),{key:0,variant:be(g.year),class:"text-xs"},{default:m(()=>[k(R(g.year),1)]),_:2},1032,["variant"])):O("",!0)])]),f(s(W),{variant:"outline",class:"text-xs shrink-0"},{default:m(()=>[k(R(Te(g.timestamp)),1)]),_:2},1024)])]),_:2},1024)]),_:2},1024))),128)),N.value.length>5?(T(),H("div",Os,[u("p",js,"+"+R(N.value.length-5)+" more students",1)])):O("",!0)])])):O("",!0),d.value&&N.value.length===0?(T(),H("div",Hs,[u("div",Js,[f(s(he),{class:"h-4 w-4 text-green-500"}),l[25]||(l[25]=u("p",{class:"text-sm font-medium text-muted-foreground"},"Last Scanned",-1)),f(s(W),{variant:"outline",class:"ml-auto text-xs"},{default:m(()=>[k(R(Te(d.value.timestamp)),1)]),_:1})]),f(s(X),{class:"border-green-200 bg-green-50/50 dark:bg-green-950/20 dark:border-green-800"},{default:m(()=>[f(s(ee),{class:"p-4"},{default:m(()=>[u("div",Qs,[f(s(Me),{class:"h-12 w-12 border-2 border-green-500 shrink-0"},{default:m(()=>[f(s(Ne),{class:"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300 font-semibold"},{default:m(()=>[k(R(Re(d.value.name)),1)]),_:1})]),_:1}),u("div",Ks,[u("div",Ys,[u("p",Gs,R(d.value.name),1),f(s(W),{variant:"default",class:"bg-green-500 hover:bg-green-500 shrink-0"},{default:m(()=>l[26]||(l[26]=[k(" Present ",-1)])),_:1,__:[26]})]),u("div",Ws,[u("div",Zs,[f(s(Dt),{class:"h-3 w-3 text-muted-foreground"}),l[27]||(l[27]=u("span",{class:"text-muted-foreground"},"ID:",-1)),u("span",Xs,R(d.value.student_id),1)]),u("div",ea,[f(s(tt),{class:"h-3 w-3 text-muted-foreground"}),l[28]||(l[28]=u("span",{class:"text-muted-foreground"},"Course:",-1)),u("span",null,R(d.value.course||"N/A"),1)]),u("div",ta,[f(s(At),{class:"h-3 w-3 text-muted-foreground"}),l[29]||(l[29]=u("span",{class:"text-muted-foreground"},"Year:",-1)),f(s(W),{variant:be(d.value.year),class:"text-xs"},{default:m(()=>[k(R(d.value.year||"N/A"),1)]),_:1},8,["variant"])]),u("div",na,[f(s(je),{class:"h-3 w-3 text-muted-foreground"}),l[30]||(l[30]=u("span",{class:"text-muted-foreground"},"Section:",-1)),u("span",null,R(d.value.section||"N/A"),1)])])])])]),_:1})]),_:1})])):O("",!0),v.value.length>0?(T(),H("div",sa,[u("div",aa,[f(s(je),{class:"h-4 w-4 text-muted-foreground"}),l[31]||(l[31]=u("p",{class:"text-sm font-medium text-muted-foreground"},"Recent Scans",-1)),f(s(W),{variant:"outline",class:"ml-auto text-xs"},{default:m(()=>[k(R(v.value.length),1)]),_:1})]),u("div",ra,[(T(!0),H(Ue,null,Ve(v.value.slice(0,5),(g,U)=>(T(),G(s(X),{key:g.student.id,class:"group hover:border-primary/50 transition-colors"},{default:m(()=>[f(s(ee),{class:"p-3"},{default:m(()=>[u("div",oa,[f(s(Me),{class:"h-8 w-8"},{default:m(()=>[f(s(Ne),{class:"text-xs"},{default:m(()=>[k(R(Re(g.student.name)),1)]),_:2},1024)]),_:2},1024),u("div",la,[u("p",ia,R(g.student.name),1),u("div",ua,[g.student.year?(T(),G(s(W),{key:0,variant:be(g.student.year),class:"text-xs"},{default:m(()=>[k(R(g.student.year),1)]),_:2},1032,["variant"])):O("",!0),u("span",da,R(g.student.student_id),1)])]),f(s(W),{variant:"outline",class:"text-xs shrink-0"},{default:m(()=>[k(R(Te(g.student.timestamp)),1)]),_:2},1024)])]),_:2},1024)]),_:2},1024))),128))])])):O("",!0),!d.value&&v.value.length===0?(T(),H("div",ca,[u("div",fa,[f(s(ze),{class:"h-6 w-6 text-muted-foreground"})]),l[32]||(l[32]=u("p",{class:"text-sm font-medium text-muted-foreground mb-1"},"No scans yet",-1)),l[33]||(l[33]=u("p",{class:"text-xs text-muted-foreground"}," Scan a student QR code to get started ",-1))])):O("",!0)])])]),_:1}),f(s(rt),{value:"manual",class:"flex-1 m-0 p-6 overflow-auto data-[state=inactive]:hidden"},{default:m(()=>[u("div",ma,[u("div",ga,[f(s(X),null,{default:m(()=>[f(s(we),{class:"text-center pb-4"},{default:m(()=>[u("div",ha,[f(s(Pe),{class:"h-8 w-8 text-primary"})]),f(s(xe),null,{default:m(()=>l[34]||(l[34]=[k("Manual Student Lookup",-1)])),_:1,__:[34]}),l[35]||(l[35]=u("p",{class:"text-sm text-muted-foreground"}," Enter student name and course to find and mark as present ",-1))]),_:1,__:[35]}),f(s(ee),{class:"space-y-4"},{default:m(()=>[u("div",pa,[f(s($e),{for:"studentName",class:"flex items-center gap-2"},{default:m(()=>[f(s(Pe),{class:"h-4 w-4 text-muted-foreground"}),l[36]||(l[36]=k(" Full Name * ",-1))]),_:1,__:[36]}),f(s(nt),{id:"studentName",modelValue:C.value,"onUpdate:modelValue":l[1]||(l[1]=g=>C.value=g),placeholder:"Enter student full name (e.g., Juan Dela Cruz)",disabled:c.value,onBlur:l[2]||(l[2]=g=>I("name",C.value)),class:Ke({"border-destructive":y.value.name})},null,8,["modelValue","disabled","class"]),y.value.name?(T(),H("p",va,R(y.value.name),1)):O("",!0)]),u("div",ya,[f(s($e),{for:"studentCourse",class:"flex items-center gap-2"},{default:m(()=>[f(s(tt),{class:"h-4 w-4 text-muted-foreground"}),l[37]||(l[37]=k(" Course * ",-1))]),_:1,__:[37]}),f(s(nt),{id:"studentCourse",modelValue:x.value,"onUpdate:modelValue":l[3]||(l[3]=g=>x.value=g),placeholder:"Enter course (e.g., BSCS, BSIT, BSEE)",disabled:c.value,onBlur:l[4]||(l[4]=g=>I("course",x.value)),class:Ke({"border-destructive":y.value.course})},null,8,["modelValue","disabled","class"]),y.value.course?(T(),H("p",_a,R(y.value.course),1)):O("",!0)]),f(s(He),{class:"border-blue-200 bg-blue-50 text-blue-900 dark:bg-blue-950 dark:text-blue-100"},{default:m(()=>[f(s(he),{class:"h-4 w-4 text-blue-600"}),f(s(Je),{class:"text-sm"},{default:m(()=>l[38]||(l[38]=[k(" Only name and course are required. The system will automatically look up the student and mark them as present. ",-1)])),_:1,__:[38]})]),_:1}),f(s(te),{onClick:qe,disabled:c.value||!C.value.trim()||!x.value.trim()||Object.values(y.value).some(g=>g),class:"w-full",size:"lg"},{default:m(()=>[f(s(he),{class:"mr-2 h-5 w-5"}),k(" "+R(c.value?"Finding Student & Marking Present...":"Find Student & Mark Present"),1)]),_:1},8,["disabled"])]),_:1})]),_:1}),f(s(X),null,{default:m(()=>[f(s(we),null,{default:m(()=>[f(s(xe),{class:"flex items-center gap-2"},{default:m(()=>[f(s(ze),{class:"h-5 w-5 text-muted-foreground"}),l[39]||(l[39]=k(" QR Code Text ",-1))]),_:1,__:[39]}),l[40]||(l[40]=u("p",{class:"text-sm text-muted-foreground"}," Paste raw QR code data (name,course format) ",-1))]),_:1,__:[40]}),f(s(ee),{class:"space-y-4"},{default:m(()=>[u("div",ba,[f(s($e),null,{default:m(()=>l[41]||(l[41]=[k("QR Code Data",-1)])),_:1,__:[41]}),f(s(Hn),{modelValue:M.value,"onUpdate:modelValue":l[5]||(l[5]=g=>M.value=g),placeholder:"EJ FAYE A. DULAY,BSCS,,",class:"min-h-[120px] font-mono text-sm resize-none",disabled:c.value},null,8,["modelValue","disabled"]),l[42]||(l[42]=u("p",{class:"text-xs text-muted-foreground"},' Enter QR code data in the format: "Student Name,Course,," (e.g., "EJ FAYE A. DULAY,BSCS,,") ',-1))]),f(s(te),{onClick:Be,disabled:c.value||!M.value.trim(),class:"w-full",size:"lg"},{default:m(()=>[f(s(he),{class:"mr-2 h-5 w-5"}),k(" "+R(c.value?"Finding Student...":"Find Student & Mark Present"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),u("div",wa,[d.value?(T(),H("div",xa,[u("div",Sa,[f(s(he),{class:"h-4 w-4 text-green-500"}),l[43]||(l[43]=u("p",{class:"text-sm font-medium text-muted-foreground"},"Last Added",-1)),f(s(W),{variant:"outline",class:"ml-auto text-xs"},{default:m(()=>[k(R(Te(d.value.timestamp)),1)]),_:1})]),f(s(X),{class:"border-green-200 bg-green-50/50 dark:bg-green-950/20"},{default:m(()=>[f(s(ee),{class:"p-4"},{default:m(()=>[u("div",Ca,[f(s(Me),{class:"h-12 w-12 border-2 border-green-500 shrink-0"},{default:m(()=>[f(s(Ne),{class:"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300 font-semibold"},{default:m(()=>[k(R(Re(d.value.name)),1)]),_:1})]),_:1}),u("div",ka,[u("div",Ea,[u("p",Ba,R(d.value.name),1),f(s(W),{variant:"default",class:"bg-green-500 hover:bg-green-500 shrink-0"},{default:m(()=>l[44]||(l[44]=[k(" Present ",-1)])),_:1,__:[44]})]),u("div",Ia,[u("div",Ra,[f(s(Dt),{class:"h-3 w-3 text-muted-foreground"}),l[45]||(l[45]=u("span",{class:"text-muted-foreground"},"ID:",-1)),u("span",Ta,R(d.value.student_id),1)]),u("div",Ma,[f(s(tt),{class:"h-3 w-3 text-muted-foreground"}),l[46]||(l[46]=u("span",{class:"text-muted-foreground"},"Course:",-1)),u("span",null,R(d.value.course||"N/A"),1)]),u("div",Na,[f(s(At),{class:"h-3 w-3 text-muted-foreground"}),l[47]||(l[47]=u("span",{class:"text-muted-foreground"},"Year:",-1)),f(s(W),{variant:be(d.value.year),class:"text-xs"},{default:m(()=>[k(R(d.value.year||"N/A"),1)]),_:1},8,["variant"])]),u("div",Pa,[f(s(je),{class:"h-3 w-3 text-muted-foreground"}),l[48]||(l[48]=u("span",{class:"text-muted-foreground"},"Section:",-1)),u("span",null,R(d.value.section||"N/A"),1)])])])])]),_:1})]),_:1})])):O("",!0),v.value.length>0?(T(),G(s(X),{key:1},{default:m(()=>[f(s(we),{class:"pb-3"},{default:m(()=>[f(s(xe),{class:"text-sm flex items-center gap-2"},{default:m(()=>[f(s(je),{class:"h-4 w-4 text-muted-foreground"}),l[49]||(l[49]=k(" Scan History ",-1))]),_:1,__:[49]})]),_:1}),f(s(ee),{class:"p-0"},{default:m(()=>[u("div",Aa,[(T(!0),H(Ue,null,Ve(v.value,(g,U)=>(T(),H("div",{key:g.student.id,class:"p-3 border-b last:border-b-0 hover:bg-muted/50 transition-colors"},[u("div",Da,[f(s(Me),{class:"h-8 w-8 shrink-0"},{default:m(()=>[f(s(Ne),{class:"text-xs"},{default:m(()=>[k(R(Re(g.student.name)),1)]),_:2},1024)]),_:2},1024),u("div",La,[u("p",qa,R(g.student.name),1),u("div",Fa,[g.student.year?(T(),G(s(W),{key:0,variant:be(g.student.year),class:"text-xs"},{default:m(()=>[k(R(g.student.year),1)]),_:2},1032,["variant"])):O("",!0),u("span",Ua,R(g.student.student_id),1)])]),u("div",Va,[f(s(W),{variant:"outline",class:"text-xs mb-1"},{default:m(()=>[k(R(Te(g.student.timestamp)),1)]),_:2},1024),u("p",$a,R(g.format),1)])])]))),128))])]),_:1})]),_:1})):O("",!0),!d.value&&v.value.length===0?(T(),H("div",za,[u("div",Oa,[f(s(Pe),{class:"h-6 w-6 text-muted-foreground"})]),l[50]||(l[50]=u("p",{class:"text-sm font-medium text-muted-foreground mb-1"},"No entries yet",-1)),l[51]||(l[51]=u("p",{class:"text-xs text-muted-foreground"}," Add a student to get started ",-1))])):O("",!0)])])]),_:1}),f(s(rt),{value:"upload",class:"flex-1 m-0 p-6 overflow-auto data-[state=inactive]:hidden"},{default:m(()=>[u("div",ja,[u("div",Ha,[f(s(X),null,{default:m(()=>[f(s(we),{class:"text-center pb-4"},{default:m(()=>[u("div",Ja,[f(s(st),{class:"h-8 w-8 text-primary"})]),f(s(xe),null,{default:m(()=>l[52]||(l[52]=[k("Bulk Student Upload",-1)])),_:1,__:[52]}),l[53]||(l[53]=u("p",{class:"text-sm text-muted-foreground"}," Upload a CSV file to import multiple students at once ",-1))]),_:1,__:[53]}),f(s(ee),{class:"space-y-4"},{default:m(()=>[u("div",Qa,[f(s($e),null,{default:m(()=>l[54]||(l[54]=[k("Select CSV File",-1)])),_:1,__:[54]}),u("div",Ka,[f(s(nt),{ref_key:"fileInput",ref:K,type:"file",accept:".csv,text/csv,application/vnd.ms-excel",onChange:Sn,disabled:c.value||b.value,class:"flex-1"},null,8,["disabled"])]),l[55]||(l[55]=u("p",{class:"text-xs text-muted-foreground"}," CSV format: student_id, name, year, course, section ",-1))]),b.value?(T(),H("div",Ya,[u("div",Ga,[l[56]||(l[56]=u("span",{class:"text-muted-foreground"},"Processing file...",-1)),u("span",Wa,R(F.value)+"%",1)]),u("div",Za,[u("div",{class:"bg-primary h-full transition-all duration-300 ease-out",style:gn({width:`${F.value}%`})},null,4)])])):O("",!0),P.value?(T(),G(s(He),{key:1,class:"border-green-200 bg-green-50 text-green-900 dark:bg-green-950 dark:text-green-100"},{default:m(()=>[f(s(he),{class:"h-4 w-4 text-green-600"}),f(s(Je),null,{default:m(()=>[k(R(P.value),1)]),_:1})]),_:1})):O("",!0),j.value?(T(),G(s(He),{key:2,variant:"destructive"},{default:m(()=>[f(s(Oe),{class:"h-4 w-4"}),f(s(Je),null,{default:m(()=>[k(R(j.value),1)]),_:1})]),_:1})):O("",!0),f(s(X),{class:"bg-muted/50"},{default:m(()=>[f(s(we),{class:"pb-3"},{default:m(()=>[f(s(xe),{class:"text-sm"},{default:m(()=>l[57]||(l[57]=[k("CSV Format Example",-1)])),_:1,__:[57]})]),_:1}),f(s(ee),{class:"space-y-2"},{default:m(()=>l[58]||(l[58]=[u("div",{class:"bg-background rounded-md p-3 font-mono text-xs overflow-x-auto"},[u("div",{class:"text-muted-foreground mb-2"},"// With header (recommended):"),u("div",null,"student_id,name,year,course,section"),u("div",null,"STU-001,John Doe,1st,BSCS,A"),u("div",null,"STU-002,Jane Smith,2nd,BSIT,B"),u("div",{class:"mt-3 text-muted-foreground"},"// Without header:"),u("div",null,"STU-001,John Doe,1st,BSCS,A"),u("div",null,"STU-002,Jane Smith,2nd,BSIT,B")],-1),u("p",{class:"text-xs text-muted-foreground"},[k(" â€¢ First two columns (student_id, name) are required"),u("br"),k(" â€¢ Year must be: 1st, 2nd, 3rd, 4th, or 5th"),u("br"),k(" â€¢ Course and section are optional ")],-1)])),_:1,__:[58]})]),_:1}),f(s(te),{onClick:kn,disabled:E.value.length===0||c.value,class:"w-full",size:"lg"},{default:m(()=>[f(s(he),{class:"mr-2 h-5 w-5"}),k(" "+R(c.value?"Saving...":`Save ${E.value.length} Student(s)`),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),u("div",Xa,[E.value.length>0?(T(),G(s(X),{key:0},{default:m(()=>[f(s(we),null,{default:m(()=>[f(s(xe),{class:"text-sm flex items-center justify-between"},{default:m(()=>[l[59]||(l[59]=u("span",null,"Parsed Students",-1)),f(s(W),{variant:"secondary"},{default:m(()=>[k(R(E.value.length),1)]),_:1})]),_:1,__:[59]})]),_:1}),f(s(ee),{class:"p-0"},{default:m(()=>[u("div",er,[(T(!0),H(Ue,null,Ve(E.value,(g,U)=>(T(),H("div",{key:g.id,class:"p-3 border-b last:border-b-0 hover:bg-muted/50 transition-colors"},[u("div",tr,[u("div",nr,[u("span",sr,R(U+1),1)]),u("div",ar,[u("p",rr,R(g.name),1),u("div",or,[f(s(W),{variant:"outline",class:"font-mono"},{default:m(()=>[k(R(g.student_id),1)]),_:2},1024),g.year?(T(),G(s(W),{key:0,variant:be(g.year)},{default:m(()=>[k(R(g.year),1)]),_:2},1032,["variant"])):O("",!0),g.course?(T(),H("span",lr,R(g.course),1)):O("",!0),g.section?(T(),H("span",ir," Sec "+R(g.section),1)):O("",!0)])])])]))),128))])]),_:1})]),_:1})):O("",!0),E.value.length===0?(T(),H("div",ur,[u("div",dr,[f(s(st),{class:"h-6 w-6 text-muted-foreground"})]),l[60]||(l[60]=u("p",{class:"text-sm font-medium text-muted-foreground mb-1"},"No file uploaded",-1)),l[61]||(l[61]=u("p",{class:"text-xs text-muted-foreground"}," Select a CSV file to import students ",-1))])):O("",!0)])])]),_:1})]),_:1},8,["value"])]),c.value?(T(),H("div",cr,[f(s(X),{class:"max-w-sm"},{default:m(()=>[f(s(ee),{class:"p-6 text-center"},{default:m(()=>[f(s(at),{class:"h-10 w-10 animate-spin mx-auto text-primary mb-4"}),l[62]||(l[62]=u("div",null,[u("p",{class:"font-semibold text-lg mb-1"},"Processing"),u("p",{class:"text-sm text-muted-foreground"},"Marking attendance...")],-1))]),_:1,__:[62]})]),_:1})])):O("",!0),r.value?(T(),H("div",fr,[u("div",mr,[f(s(He),{variant:"destructive"},{default:m(()=>[f(s(Oe),{class:"h-4 w-4"}),f(s(Je),null,{default:m(()=>[k(R(r.value),1)]),_:1})]),_:1})])])):O("",!0)])])):O("",!0)}}}),ro=Tn(gr,[["__scopeId","data-v-a0c7a89a"]]);var Se={},lt,qt;function hr(){return qt||(qt=1,lt=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),lt}var it={},ce={},Ft;function ve(){if(Ft)return ce;Ft=1;let o;const a=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return ce.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return t*4+17},ce.getSymbolTotalCodewords=function(t){return a[t]},ce.getBCHDigit=function(i){let t=0;for(;i!==0;)t++,i>>>=1;return t},ce.setToSJISFunction=function(t){if(typeof t!="function")throw new Error('"toSJISFunc" is not a valid function.');o=t},ce.isKanjiModeEnabled=function(){return typeof o<"u"},ce.toSJIS=function(t){return o(t)},ce}var ut={},Ut;function Mt(){return Ut||(Ut=1,(function(o){o.L={bit:1},o.M={bit:0},o.Q={bit:3},o.H={bit:2};function a(i){if(typeof i!="string")throw new Error("Param is not a string");switch(i.toLowerCase()){case"l":case"low":return o.L;case"m":case"medium":return o.M;case"q":case"quartile":return o.Q;case"h":case"high":return o.H;default:throw new Error("Unknown EC Level: "+i)}}o.isValid=function(t){return t&&typeof t.bit<"u"&&t.bit>=0&&t.bit<4},o.from=function(t,e){if(o.isValid(t))return t;try{return a(t)}catch{return e}}})(ut)),ut}var dt,Vt;function pr(){if(Vt)return dt;Vt=1;function o(){this.buffer=[],this.length=0}return o.prototype={get:function(a){const i=Math.floor(a/8);return(this.buffer[i]>>>7-a%8&1)===1},put:function(a,i){for(let t=0;t<i;t++)this.putBit((a>>>i-t-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(a){const i=Math.floor(this.length/8);this.buffer.length<=i&&this.buffer.push(0),a&&(this.buffer[i]|=128>>>this.length%8),this.length++}},dt=o,dt}var ct,$t;function vr(){if($t)return ct;$t=1;function o(a){if(!a||a<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=a,this.data=new Uint8Array(a*a),this.reservedBit=new Uint8Array(a*a)}return o.prototype.set=function(a,i,t,e){const n=a*this.size+i;this.data[n]=t,e&&(this.reservedBit[n]=!0)},o.prototype.get=function(a,i){return this.data[a*this.size+i]},o.prototype.xor=function(a,i,t){this.data[a*this.size+i]^=t},o.prototype.isReserved=function(a,i){return this.reservedBit[a*this.size+i]},ct=o,ct}var ft={},zt;function yr(){return zt||(zt=1,(function(o){const a=ve().getSymbolSize;o.getRowColCoords=function(t){if(t===1)return[];const e=Math.floor(t/7)+2,n=a(t),r=n===145?26:Math.ceil((n-13)/(2*e-2))*2,c=[n-7];for(let d=1;d<e-1;d++)c[d]=c[d-1]-r;return c.push(6),c.reverse()},o.getPositions=function(t){const e=[],n=o.getRowColCoords(t),r=n.length;for(let c=0;c<r;c++)for(let d=0;d<r;d++)c===0&&d===0||c===0&&d===r-1||c===r-1&&d===0||e.push([n[c],n[d]]);return e}})(ft)),ft}var mt={},Ot;function _r(){if(Ot)return mt;Ot=1;const o=ve().getSymbolSize,a=7;return mt.getPositions=function(t){const e=o(t);return[[0,0],[e-a,0],[0,e-a]]},mt}var gt={},jt;function br(){return jt||(jt=1,(function(o){o.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const a={N1:3,N2:3,N3:40,N4:10};o.isValid=function(e){return e!=null&&e!==""&&!isNaN(e)&&e>=0&&e<=7},o.from=function(e){return o.isValid(e)?parseInt(e,10):void 0},o.getPenaltyN1=function(e){const n=e.size;let r=0,c=0,d=0,p=null,_=null;for(let M=0;M<n;M++){c=d=0,p=_=null;for(let w=0;w<n;w++){let v=e.get(M,w);v===p?c++:(c>=5&&(r+=a.N1+(c-5)),p=v,c=1),v=e.get(w,M),v===_?d++:(d>=5&&(r+=a.N1+(d-5)),_=v,d=1)}c>=5&&(r+=a.N1+(c-5)),d>=5&&(r+=a.N1+(d-5))}return r},o.getPenaltyN2=function(e){const n=e.size;let r=0;for(let c=0;c<n-1;c++)for(let d=0;d<n-1;d++){const p=e.get(c,d)+e.get(c,d+1)+e.get(c+1,d)+e.get(c+1,d+1);(p===4||p===0)&&r++}return r*a.N2},o.getPenaltyN3=function(e){const n=e.size;let r=0,c=0,d=0;for(let p=0;p<n;p++){c=d=0;for(let _=0;_<n;_++)c=c<<1&2047|e.get(p,_),_>=10&&(c===1488||c===93)&&r++,d=d<<1&2047|e.get(_,p),_>=10&&(d===1488||d===93)&&r++}return r*a.N3},o.getPenaltyN4=function(e){let n=0;const r=e.data.length;for(let d=0;d<r;d++)n+=e.data[d];return Math.abs(Math.ceil(n*100/r/5)-10)*a.N4};function i(t,e,n){switch(t){case o.Patterns.PATTERN000:return(e+n)%2===0;case o.Patterns.PATTERN001:return e%2===0;case o.Patterns.PATTERN010:return n%3===0;case o.Patterns.PATTERN011:return(e+n)%3===0;case o.Patterns.PATTERN100:return(Math.floor(e/2)+Math.floor(n/3))%2===0;case o.Patterns.PATTERN101:return e*n%2+e*n%3===0;case o.Patterns.PATTERN110:return(e*n%2+e*n%3)%2===0;case o.Patterns.PATTERN111:return(e*n%3+(e+n)%2)%2===0;default:throw new Error("bad maskPattern:"+t)}}o.applyMask=function(e,n){const r=n.size;for(let c=0;c<r;c++)for(let d=0;d<r;d++)n.isReserved(d,c)||n.xor(d,c,i(e,d,c))},o.getBestMask=function(e,n){const r=Object.keys(o.Patterns).length;let c=0,d=1/0;for(let p=0;p<r;p++){n(p),o.applyMask(p,e);const _=o.getPenaltyN1(e)+o.getPenaltyN2(e)+o.getPenaltyN3(e)+o.getPenaltyN4(e);o.applyMask(p,e),_<d&&(d=_,c=p)}return c}})(gt)),gt}var Qe={},Ht;function vn(){if(Ht)return Qe;Ht=1;const o=Mt(),a=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],i=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return Qe.getBlocksCount=function(e,n){switch(n){case o.L:return a[(e-1)*4+0];case o.M:return a[(e-1)*4+1];case o.Q:return a[(e-1)*4+2];case o.H:return a[(e-1)*4+3];default:return}},Qe.getTotalCodewordsCount=function(e,n){switch(n){case o.L:return i[(e-1)*4+0];case o.M:return i[(e-1)*4+1];case o.Q:return i[(e-1)*4+2];case o.H:return i[(e-1)*4+3];default:return}},Qe}var ht={},Ae={},Jt;function wr(){if(Jt)return Ae;Jt=1;const o=new Uint8Array(512),a=new Uint8Array(256);return(function(){let t=1;for(let e=0;e<255;e++)o[e]=t,a[t]=e,t<<=1,t&256&&(t^=285);for(let e=255;e<512;e++)o[e]=o[e-255]})(),Ae.log=function(t){if(t<1)throw new Error("log("+t+")");return a[t]},Ae.exp=function(t){return o[t]},Ae.mul=function(t,e){return t===0||e===0?0:o[a[t]+a[e]]},Ae}var Qt;function xr(){return Qt||(Qt=1,(function(o){const a=wr();o.mul=function(t,e){const n=new Uint8Array(t.length+e.length-1);for(let r=0;r<t.length;r++)for(let c=0;c<e.length;c++)n[r+c]^=a.mul(t[r],e[c]);return n},o.mod=function(t,e){let n=new Uint8Array(t);for(;n.length-e.length>=0;){const r=n[0];for(let d=0;d<e.length;d++)n[d]^=a.mul(e[d],r);let c=0;for(;c<n.length&&n[c]===0;)c++;n=n.slice(c)}return n},o.generateECPolynomial=function(t){let e=new Uint8Array([1]);for(let n=0;n<t;n++)e=o.mul(e,new Uint8Array([1,a.exp(n)]));return e}})(ht)),ht}var pt,Kt;function Sr(){if(Kt)return pt;Kt=1;const o=xr();function a(i){this.genPoly=void 0,this.degree=i,this.degree&&this.initialize(this.degree)}return a.prototype.initialize=function(t){this.degree=t,this.genPoly=o.generateECPolynomial(this.degree)},a.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");const e=new Uint8Array(t.length+this.degree);e.set(t);const n=o.mod(e,this.genPoly),r=this.degree-n.length;if(r>0){const c=new Uint8Array(this.degree);return c.set(n,r),c}return n},pt=a,pt}var vt={},yt={},_t={},Yt;function yn(){return Yt||(Yt=1,_t.isValid=function(a){return!isNaN(a)&&a>=1&&a<=40}),_t}var le={},Gt;function _n(){if(Gt)return le;Gt=1;const o="[0-9]+",a="[A-Z $%*+\\-./:]+";let i="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";i=i.replace(/u/g,"\\u");const t="(?:(?![A-Z0-9 $%*+\\-./:]|"+i+`)(?:.|[\r
]))+`;le.KANJI=new RegExp(i,"g"),le.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),le.BYTE=new RegExp(t,"g"),le.NUMERIC=new RegExp(o,"g"),le.ALPHANUMERIC=new RegExp(a,"g");const e=new RegExp("^"+i+"$"),n=new RegExp("^"+o+"$"),r=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return le.testKanji=function(d){return e.test(d)},le.testNumeric=function(d){return n.test(d)},le.testAlphanumeric=function(d){return r.test(d)},le}var Wt;function ye(){return Wt||(Wt=1,(function(o){const a=yn(),i=_n();o.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},o.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},o.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},o.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},o.MIXED={bit:-1},o.getCharCountIndicator=function(n,r){if(!n.ccBits)throw new Error("Invalid mode: "+n);if(!a.isValid(r))throw new Error("Invalid version: "+r);return r>=1&&r<10?n.ccBits[0]:r<27?n.ccBits[1]:n.ccBits[2]},o.getBestModeForData=function(n){return i.testNumeric(n)?o.NUMERIC:i.testAlphanumeric(n)?o.ALPHANUMERIC:i.testKanji(n)?o.KANJI:o.BYTE},o.toString=function(n){if(n&&n.id)return n.id;throw new Error("Invalid mode")},o.isValid=function(n){return n&&n.bit&&n.ccBits};function t(e){if(typeof e!="string")throw new Error("Param is not a string");switch(e.toLowerCase()){case"numeric":return o.NUMERIC;case"alphanumeric":return o.ALPHANUMERIC;case"kanji":return o.KANJI;case"byte":return o.BYTE;default:throw new Error("Unknown mode: "+e)}}o.from=function(n,r){if(o.isValid(n))return n;try{return t(n)}catch{return r}}})(yt)),yt}var Zt;function Cr(){return Zt||(Zt=1,(function(o){const a=ve(),i=vn(),t=Mt(),e=ye(),n=yn(),r=7973,c=a.getBCHDigit(r);function d(w,v,B){for(let N=1;N<=40;N++)if(v<=o.getCapacity(N,B,w))return N}function p(w,v){return e.getCharCountIndicator(w,v)+4}function _(w,v){let B=0;return w.forEach(function(N){const K=p(N.mode,v);B+=K+N.getBitsLength()}),B}function M(w,v){for(let B=1;B<=40;B++)if(_(w,B)<=o.getCapacity(B,v,e.MIXED))return B}o.from=function(v,B){return n.isValid(v)?parseInt(v,10):B},o.getCapacity=function(v,B,N){if(!n.isValid(v))throw new Error("Invalid QR Code version");typeof N>"u"&&(N=e.BYTE);const K=a.getSymbolTotalCodewords(v),q=i.getTotalCodewordsCount(v,B),F=(K-q)*8;if(N===e.MIXED)return F;const E=F-p(N,v);switch(N){case e.NUMERIC:return Math.floor(E/10*3);case e.ALPHANUMERIC:return Math.floor(E/11*2);case e.KANJI:return Math.floor(E/13);case e.BYTE:default:return Math.floor(E/8)}},o.getBestVersionForData=function(v,B){let N;const K=t.from(B,t.M);if(Array.isArray(v)){if(v.length>1)return M(v,K);if(v.length===0)return 1;N=v[0]}else N=v;return d(N.mode,N.getLength(),K)},o.getEncodedBits=function(v){if(!n.isValid(v)||v<7)throw new Error("Invalid QR Code version");let B=v<<12;for(;a.getBCHDigit(B)-c>=0;)B^=r<<a.getBCHDigit(B)-c;return v<<12|B}})(vt)),vt}var bt={},Xt;function kr(){if(Xt)return bt;Xt=1;const o=ve(),a=1335,i=21522,t=o.getBCHDigit(a);return bt.getEncodedBits=function(n,r){const c=n.bit<<3|r;let d=c<<10;for(;o.getBCHDigit(d)-t>=0;)d^=a<<o.getBCHDigit(d)-t;return(c<<10|d)^i},bt}var wt={},xt,en;function Er(){if(en)return xt;en=1;const o=ye();function a(i){this.mode=o.NUMERIC,this.data=i.toString()}return a.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(t){let e,n,r;for(e=0;e+3<=this.data.length;e+=3)n=this.data.substr(e,3),r=parseInt(n,10),t.put(r,10);const c=this.data.length-e;c>0&&(n=this.data.substr(e),r=parseInt(n,10),t.put(r,c*3+1))},xt=a,xt}var St,tn;function Br(){if(tn)return St;tn=1;const o=ye(),a=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function i(t){this.mode=o.ALPHANUMERIC,this.data=t}return i.getBitsLength=function(e){return 11*Math.floor(e/2)+6*(e%2)},i.prototype.getLength=function(){return this.data.length},i.prototype.getBitsLength=function(){return i.getBitsLength(this.data.length)},i.prototype.write=function(e){let n;for(n=0;n+2<=this.data.length;n+=2){let r=a.indexOf(this.data[n])*45;r+=a.indexOf(this.data[n+1]),e.put(r,11)}this.data.length%2&&e.put(a.indexOf(this.data[n]),6)},St=i,St}var Ct,nn;function Ir(){if(nn)return Ct;nn=1;const o=ye();function a(i){this.mode=o.BYTE,typeof i=="string"?this.data=new TextEncoder().encode(i):this.data=new Uint8Array(i)}return a.getBitsLength=function(t){return t*8},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(i){for(let t=0,e=this.data.length;t<e;t++)i.put(this.data[t],8)},Ct=a,Ct}var kt,sn;function Rr(){if(sn)return kt;sn=1;const o=ye(),a=ve();function i(t){this.mode=o.KANJI,this.data=t}return i.getBitsLength=function(e){return e*13},i.prototype.getLength=function(){return this.data.length},i.prototype.getBitsLength=function(){return i.getBitsLength(this.data.length)},i.prototype.write=function(t){let e;for(e=0;e<this.data.length;e++){let n=a.toSJIS(this.data[e]);if(n>=33088&&n<=40956)n-=33088;else if(n>=57408&&n<=60351)n-=49472;else throw new Error("Invalid SJIS character: "+this.data[e]+`
Make sure your charset is UTF-8`);n=(n>>>8&255)*192+(n&255),t.put(n,13)}},kt=i,kt}var Et={exports:{}},an;function Tr(){return an||(an=1,(function(o){var a={single_source_shortest_paths:function(i,t,e){var n={},r={};r[t]=0;var c=a.PriorityQueue.make();c.push(t,0);for(var d,p,_,M,w,v,B,N,K;!c.empty();){d=c.pop(),p=d.value,M=d.cost,w=i[p]||{};for(_ in w)w.hasOwnProperty(_)&&(v=w[_],B=M+v,N=r[_],K=typeof r[_]>"u",(K||N>B)&&(r[_]=B,c.push(_,B),n[_]=p))}if(typeof e<"u"&&typeof r[e]>"u"){var q=["Could not find a path from ",t," to ",e,"."].join("");throw new Error(q)}return n},extract_shortest_path_from_predecessor_list:function(i,t){for(var e=[],n=t;n;)e.push(n),i[n],n=i[n];return e.reverse(),e},find_path:function(i,t,e){var n=a.single_source_shortest_paths(i,t,e);return a.extract_shortest_path_from_predecessor_list(n,e)},PriorityQueue:{make:function(i){var t=a.PriorityQueue,e={},n;i=i||{};for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e.queue=[],e.sorter=i.sorter||t.default_sorter,e},default_sorter:function(i,t){return i.cost-t.cost},push:function(i,t){var e={value:i,cost:t};this.queue.push(e),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};o.exports=a})(Et)),Et.exports}var rn;function Mr(){return rn||(rn=1,(function(o){const a=ye(),i=Er(),t=Br(),e=Ir(),n=Rr(),r=_n(),c=ve(),d=Tr();function p(q){return unescape(encodeURIComponent(q)).length}function _(q,F,E){const P=[];let j;for(;(j=q.exec(E))!==null;)P.push({data:j[0],index:j.index,mode:F,length:j[0].length});return P}function M(q){const F=_(r.NUMERIC,a.NUMERIC,q),E=_(r.ALPHANUMERIC,a.ALPHANUMERIC,q);let P,j;return c.isKanjiModeEnabled()?(P=_(r.BYTE,a.BYTE,q),j=_(r.KANJI,a.KANJI,q)):(P=_(r.BYTE_KANJI,a.BYTE,q),j=[]),F.concat(E,P,j).sort(function(C,x){return C.index-x.index}).map(function(C){return{data:C.data,mode:C.mode,length:C.length}})}function w(q,F){switch(F){case a.NUMERIC:return i.getBitsLength(q);case a.ALPHANUMERIC:return t.getBitsLength(q);case a.KANJI:return n.getBitsLength(q);case a.BYTE:return e.getBitsLength(q)}}function v(q){return q.reduce(function(F,E){const P=F.length-1>=0?F[F.length-1]:null;return P&&P.mode===E.mode?(F[F.length-1].data+=E.data,F):(F.push(E),F)},[])}function B(q){const F=[];for(let E=0;E<q.length;E++){const P=q[E];switch(P.mode){case a.NUMERIC:F.push([P,{data:P.data,mode:a.ALPHANUMERIC,length:P.length},{data:P.data,mode:a.BYTE,length:P.length}]);break;case a.ALPHANUMERIC:F.push([P,{data:P.data,mode:a.BYTE,length:P.length}]);break;case a.KANJI:F.push([P,{data:P.data,mode:a.BYTE,length:p(P.data)}]);break;case a.BYTE:F.push([{data:P.data,mode:a.BYTE,length:p(P.data)}])}}return F}function N(q,F){const E={},P={start:{}};let j=["start"];for(let b=0;b<q.length;b++){const C=q[b],x=[];for(let y=0;y<C.length;y++){const D=C[y],I=""+b+y;x.push(I),E[I]={node:D,lastCount:0},P[I]={};for(let A=0;A<j.length;A++){const S=j[A];E[S]&&E[S].node.mode===D.mode?(P[S][I]=w(E[S].lastCount+D.length,D.mode)-w(E[S].lastCount,D.mode),E[S].lastCount+=D.length):(E[S]&&(E[S].lastCount=D.length),P[S][I]=w(D.length,D.mode)+4+a.getCharCountIndicator(D.mode,F))}}j=x}for(let b=0;b<j.length;b++)P[j[b]].end=0;return{map:P,table:E}}function K(q,F){let E;const P=a.getBestModeForData(q);if(E=a.from(F,P),E!==a.BYTE&&E.bit<P.bit)throw new Error('"'+q+'" cannot be encoded with mode '+a.toString(E)+`.
 Suggested mode is: `+a.toString(P));switch(E===a.KANJI&&!c.isKanjiModeEnabled()&&(E=a.BYTE),E){case a.NUMERIC:return new i(q);case a.ALPHANUMERIC:return new t(q);case a.KANJI:return new n(q);case a.BYTE:return new e(q)}}o.fromArray=function(F){return F.reduce(function(E,P){return typeof P=="string"?E.push(K(P,null)):P.data&&E.push(K(P.data,P.mode)),E},[])},o.fromString=function(F,E){const P=M(F,c.isKanjiModeEnabled()),j=B(P),b=N(j,E),C=d.find_path(b.map,"start","end"),x=[];for(let y=1;y<C.length-1;y++)x.push(b.table[C[y]].node);return o.fromArray(v(x))},o.rawSplit=function(F){return o.fromArray(M(F,c.isKanjiModeEnabled()))}})(wt)),wt}var on;function Nr(){if(on)return it;on=1;const o=ve(),a=Mt(),i=pr(),t=vr(),e=yr(),n=_r(),r=br(),c=vn(),d=Sr(),p=Cr(),_=kr(),M=ye(),w=Mr();function v(b,C){const x=b.size,y=n.getPositions(C);for(let D=0;D<y.length;D++){const I=y[D][0],A=y[D][1];for(let S=-1;S<=7;S++)if(!(I+S<=-1||x<=I+S))for(let L=-1;L<=7;L++)A+L<=-1||x<=A+L||(S>=0&&S<=6&&(L===0||L===6)||L>=0&&L<=6&&(S===0||S===6)||S>=2&&S<=4&&L>=2&&L<=4?b.set(I+S,A+L,!0,!0):b.set(I+S,A+L,!1,!0))}}function B(b){const C=b.size;for(let x=8;x<C-8;x++){const y=x%2===0;b.set(x,6,y,!0),b.set(6,x,y,!0)}}function N(b,C){const x=e.getPositions(C);for(let y=0;y<x.length;y++){const D=x[y][0],I=x[y][1];for(let A=-2;A<=2;A++)for(let S=-2;S<=2;S++)A===-2||A===2||S===-2||S===2||A===0&&S===0?b.set(D+A,I+S,!0,!0):b.set(D+A,I+S,!1,!0)}}function K(b,C){const x=b.size,y=p.getEncodedBits(C);let D,I,A;for(let S=0;S<18;S++)D=Math.floor(S/3),I=S%3+x-8-3,A=(y>>S&1)===1,b.set(D,I,A,!0),b.set(I,D,A,!0)}function q(b,C,x){const y=b.size,D=_.getEncodedBits(C,x);let I,A;for(I=0;I<15;I++)A=(D>>I&1)===1,I<6?b.set(I,8,A,!0):I<8?b.set(I+1,8,A,!0):b.set(y-15+I,8,A,!0),I<8?b.set(8,y-I-1,A,!0):I<9?b.set(8,15-I-1+1,A,!0):b.set(8,15-I-1,A,!0);b.set(y-8,8,1,!0)}function F(b,C){const x=b.size;let y=-1,D=x-1,I=7,A=0;for(let S=x-1;S>0;S-=2)for(S===6&&S--;;){for(let L=0;L<2;L++)if(!b.isReserved(D,S-L)){let re=!1;A<C.length&&(re=(C[A]>>>I&1)===1),b.set(D,S-L,re),I--,I===-1&&(A++,I=7)}if(D+=y,D<0||x<=D){D-=y,y=-y;break}}}function E(b,C,x){const y=new i;x.forEach(function(L){y.put(L.mode.bit,4),y.put(L.getLength(),M.getCharCountIndicator(L.mode,b)),L.write(y)});const D=o.getSymbolTotalCodewords(b),I=c.getTotalCodewordsCount(b,C),A=(D-I)*8;for(y.getLengthInBits()+4<=A&&y.put(0,4);y.getLengthInBits()%8!==0;)y.putBit(0);const S=(A-y.getLengthInBits())/8;for(let L=0;L<S;L++)y.put(L%2?17:236,8);return P(y,b,C)}function P(b,C,x){const y=o.getSymbolTotalCodewords(C),D=c.getTotalCodewordsCount(C,x),I=y-D,A=c.getBlocksCount(C,x),S=y%A,L=A-S,re=Math.floor(y/A),me=Math.floor(I/A),Xe=me+1,De=re-me,ue=new d(De);let ke=0;const _e=new Array(A),ge=new Array(A);let Ee=0;const Le=new Uint8Array(b.buffer);for(let de=0;de<A;de++){const Ie=de<L?me:Xe;_e[de]=Le.slice(ke,ke+Ie),ge[de]=ue.encode(_e[de]),ke+=Ie,Ee=Math.max(Ee,Ie)}const Be=new Uint8Array(y);let qe=0,ne,se;for(ne=0;ne<Ee;ne++)for(se=0;se<A;se++)ne<_e[se].length&&(Be[qe++]=_e[se][ne]);for(ne=0;ne<De;ne++)for(se=0;se<A;se++)Be[qe++]=ge[se][ne];return Be}function j(b,C,x,y){let D;if(Array.isArray(b))D=w.fromArray(b);else if(typeof b=="string"){let re=C;if(!re){const me=w.rawSplit(b);re=p.getBestVersionForData(me,x)}D=w.fromString(b,re||40)}else throw new Error("Invalid data");const I=p.getBestVersionForData(D,x);if(!I)throw new Error("The amount of data is too big to be stored in a QR Code");if(!C)C=I;else if(C<I)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+I+`.
`);const A=E(C,x,D),S=o.getSymbolSize(C),L=new t(S);return v(L,C),B(L),N(L,C),q(L,x,0),C>=7&&K(L,C),F(L,A),isNaN(y)&&(y=r.getBestMask(L,q.bind(null,L,x))),r.applyMask(y,L),q(L,x,y),{modules:L,version:C,errorCorrectionLevel:x,maskPattern:y,segments:D}}return it.create=function(C,x){if(typeof C>"u"||C==="")throw new Error("No input text");let y=a.M,D,I;return typeof x<"u"&&(y=a.from(x.errorCorrectionLevel,a.M),D=p.from(x.version),I=r.from(x.maskPattern),x.toSJISFunc&&o.setToSJISFunction(x.toSJISFunc)),j(C,D,y,I)},it}var Bt={},It={},ln;function bn(){return ln||(ln=1,(function(o){function a(i){if(typeof i=="number"&&(i=i.toString()),typeof i!="string")throw new Error("Color should be defined as hex string");let t=i.slice().replace("#","").split("");if(t.length<3||t.length===5||t.length>8)throw new Error("Invalid hex color: "+i);(t.length===3||t.length===4)&&(t=Array.prototype.concat.apply([],t.map(function(n){return[n,n]}))),t.length===6&&t.push("F","F");const e=parseInt(t.join(""),16);return{r:e>>24&255,g:e>>16&255,b:e>>8&255,a:e&255,hex:"#"+t.slice(0,6).join("")}}o.getOptions=function(t){t||(t={}),t.color||(t.color={});const e=typeof t.margin>"u"||t.margin===null||t.margin<0?4:t.margin,n=t.width&&t.width>=21?t.width:void 0,r=t.scale||4;return{width:n,scale:n?4:r,margin:e,color:{dark:a(t.color.dark||"#000000ff"),light:a(t.color.light||"#ffffffff")},type:t.type,rendererOpts:t.rendererOpts||{}}},o.getScale=function(t,e){return e.width&&e.width>=t+e.margin*2?e.width/(t+e.margin*2):e.scale},o.getImageWidth=function(t,e){const n=o.getScale(t,e);return Math.floor((t+e.margin*2)*n)},o.qrToImageData=function(t,e,n){const r=e.modules.size,c=e.modules.data,d=o.getScale(r,n),p=Math.floor((r+n.margin*2)*d),_=n.margin*d,M=[n.color.light,n.color.dark];for(let w=0;w<p;w++)for(let v=0;v<p;v++){let B=(w*p+v)*4,N=n.color.light;if(w>=_&&v>=_&&w<p-_&&v<p-_){const K=Math.floor((w-_)/d),q=Math.floor((v-_)/d);N=M[c[K*r+q]?1:0]}t[B++]=N.r,t[B++]=N.g,t[B++]=N.b,t[B]=N.a}}})(It)),It}var un;function Pr(){return un||(un=1,(function(o){const a=bn();function i(e,n,r){e.clearRect(0,0,n.width,n.height),n.style||(n.style={}),n.height=r,n.width=r,n.style.height=r+"px",n.style.width=r+"px"}function t(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}o.render=function(n,r,c){let d=c,p=r;typeof d>"u"&&(!r||!r.getContext)&&(d=r,r=void 0),r||(p=t()),d=a.getOptions(d);const _=a.getImageWidth(n.modules.size,d),M=p.getContext("2d"),w=M.createImageData(_,_);return a.qrToImageData(w.data,n,d),i(M,p,_),M.putImageData(w,0,0),p},o.renderToDataURL=function(n,r,c){let d=c;typeof d>"u"&&(!r||!r.getContext)&&(d=r,r=void 0),d||(d={});const p=o.render(n,r,d),_=d.type||"image/png",M=d.rendererOpts||{};return p.toDataURL(_,M.quality)}})(Bt)),Bt}var Rt={},dn;function Ar(){if(dn)return Rt;dn=1;const o=bn();function a(e,n){const r=e.a/255,c=n+'="'+e.hex+'"';return r<1?c+" "+n+'-opacity="'+r.toFixed(2).slice(1)+'"':c}function i(e,n,r){let c=e+n;return typeof r<"u"&&(c+=" "+r),c}function t(e,n,r){let c="",d=0,p=!1,_=0;for(let M=0;M<e.length;M++){const w=Math.floor(M%n),v=Math.floor(M/n);!w&&!p&&(p=!0),e[M]?(_++,M>0&&w>0&&e[M-1]||(c+=p?i("M",w+r,.5+v+r):i("m",d,0),d=0,p=!1),w+1<n&&e[M+1]||(c+=i("h",_),_=0)):d++}return c}return Rt.render=function(n,r,c){const d=o.getOptions(r),p=n.modules.size,_=n.modules.data,M=p+d.margin*2,w=d.color.light.a?"<path "+a(d.color.light,"fill")+' d="M0 0h'+M+"v"+M+'H0z"/>':"",v="<path "+a(d.color.dark,"stroke")+' d="'+t(_,p,d.margin)+'"/>',B='viewBox="0 0 '+M+" "+M+'"',K='<svg xmlns="http://www.w3.org/2000/svg" '+(d.width?'width="'+d.width+'" height="'+d.width+'" ':"")+B+' shape-rendering="crispEdges">'+w+v+`</svg>
`;return typeof c=="function"&&c(null,K),K},Rt}var cn;function Dr(){if(cn)return Se;cn=1;const o=hr(),a=Nr(),i=Pr(),t=Ar();function e(n,r,c,d,p){const _=[].slice.call(arguments,1),M=_.length,w=typeof _[M-1]=="function";if(!w&&!o())throw new Error("Callback required as last argument");if(w){if(M<2)throw new Error("Too few arguments provided");M===2?(p=c,c=r,r=d=void 0):M===3&&(r.getContext&&typeof p>"u"?(p=d,d=void 0):(p=d,d=c,c=r,r=void 0))}else{if(M<1)throw new Error("Too few arguments provided");return M===1?(c=r,r=d=void 0):M===2&&!r.getContext&&(d=c,c=r,r=void 0),new Promise(function(v,B){try{const N=a.create(c,d);v(n(N,r,d))}catch(N){B(N)}})}try{const v=a.create(c,d);p(null,n(v,r,d))}catch(v){p(v)}}return Se.create=a.create,Se.toCanvas=e.bind(null,i.render),Se.toDataURL=e.bind(null,i.renderToDataURL),Se.toString=e.bind(null,function(n,r,c){return t.render(n,c)}),Se}var Lr=Dr();const oo=Dn(Lr);export{so as E,ro as Q,ao as S,os as _,ls as a,ot as b,rt as c,He as d,Je as e,oo as f};
